<!DOCTYPE html>

<html lang="en">

<head>

  <meta charset="UTF-8" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <title>Creator Dashboard - EverNet</title>

  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Montserrat:wght@700;800;900&display=swap" rel="stylesheet">

  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>

  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>

  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  

  <!-- Add Chart.js for earnings chart -->

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  

  <style>

    :root {

      --navy: #001f3f;

      --dark-navy: #00152c;

      --gold: #d4af37;

      --light-gold: #e6d4a8;

      --white: #ffffff;

      --light: #f8fafc;

      --shadow: rgba(0, 31, 63, 0.1);

      --gradient: linear-gradient(135deg, var(--navy) 0%, #0a2458 100%);

      --card-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);

      --hover-shadow: 0 20px 40px rgba(0, 0, 0, 0.12);

      --success: #28a745;

      --warning: #ffc107;

      --danger: #dc3545;

      --creator: #8B5CF6;

    }



    /* Dark Theme Variables - MATCHING ADMIN PORTAL */

    [data-theme="dark"] {

      --bg-color: #0f172a;

      --text-color: #f1f5f9;

      --card-bg: #1e293b;

      --border-color: #334155;

      --navy: #f1f5f9;

      --dark-navy: #0a1121;

      --white: #1e293b;

      --light: #0f172a;

      --shadow: rgba(0, 0, 0, 0.3);

      --card-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);

      --hover-shadow: 0 20px 40px rgba(0, 0, 0, 0.4);

    }



    [data-theme="dark"] body {

      background: var(--bg-color);

      color: var(--text-color);

    }



    /* Apply dark theme to all main components */

    [data-theme="dark"] .stat-card,

    [data-theme="dark"] .youtube-section,

    [data-theme="dark"] .withdrawal-section,

    [data-theme="dark"] .paypal-section,

    [data-theme="dark"] .settings-section,

    [data-theme="dark"] .withdrawal-history-section,

    [data-theme="dark"] .monthly-balance-card,

    [data-theme="dark"] .video-performance-card,

    [data-theme="dark"] .monthly-report-card,

    [data-theme="dark"] .notification-detail,

    [data-theme="dark"] .analytics-chart,

    [data-theme="dark"] .stat-card-enhanced,

    [data-theme="dark"] .today-earnings-section {

      background: var(--card-bg);

      border: 1px solid var(--border-color);

      color: var(--text-color);

    }



    /* Ensure text visibility */

    [data-theme="dark"] .section-title,

    [data-theme="dark"] .settings-title,

    [data-theme="dark"] .modal-title,

    [data-theme="dark"] .dashboard-title,

    [data-theme="dark"] .stat-value,

    [data-theme="dark"] .stat-number-enhanced,

    [data-theme="dark"] .balance-display,

    [data-theme="dark"] .month-name,

    [data-theme="dark"] .video-title,

    [data-theme="dark"] .report-month,

    [data-theme="dark"] .video-stat-value,

    [data-theme="dark"] .month-stat-value,

    [data-theme="dark"] .report-stat-value,

    [data-theme="dark"] .today-earnings-value,

    [data-theme="dark"] .earnings-change {

      color: var(--text-color);

    }



    /* Secondary text */

    [data-theme="dark"] .stat-label,

    [data-theme="dark"] .stat-label-enhanced,

    [data-theme="dark"] .month-stat-label,

    [data-theme="dark"] .video-stat-label,

    [data-theme="dark"] .report-stat-label,

    [data-theme="dark"] .video-earnings-label,

    [data-theme="dark"] .report-earnings-label,

    [data-theme="dark"] .greeting,

    [data-theme="dark"] .today-earnings-label {

      color: #94a3b8;

    }



    * {

      margin: 0;

      padding: 0;

      box-sizing: border-box;

      font-family: "Poppins", sans-serif;

    }



    body {

      background: #f8fafc;

      color: var(--navy);

      overflow-x: hidden;

      line-height: 1.7;

      min-height: 100vh;

      display: flex;

      flex-direction: column;

      transition: background-color 0.3s ease, color 0.3s ease;

    }



    header {

      background: rgba(255, 255, 255, 0.98);

      backdrop-filter: blur(20px);

      box-shadow: 0 4px 30px rgba(0, 0, 0, 0.08);

      padding: 18px 5%;

      position: sticky;

      top: 0;

      z-index: 1000;

      display: flex;

      align-items: center;

      justify-content: space-between;

      min-height: 80px;

      border-bottom: 1px solid rgba(0, 31, 63, 0.05);

      transition: all 0.3s ease;

    }



    [data-theme="dark"] header {

      background: rgba(26, 26, 26, 0.98);

      border-bottom: 1px solid rgba(255, 255, 255, 0.05);

    }



    .brand {

      font-family: "Montserrat", sans-serif;

      font-size: clamp(1.5em, 5vw, 1.9em);

      font-weight: 900;

      color: var(--navy);

      letter-spacing: 1.5px;

      text-transform: uppercase;

      white-space: nowrap;

      background: linear-gradient(135deg, var(--navy) 0%, var(--creator) 100%);

      -webkit-background-clip: text;

      -webkit-text-fill-color: transparent;

      background-clip: text;

    }



    /* Home Button Styles */

    .home-btn {

      display: inline-flex;

      align-items: center;

      gap: 8px;

      padding: 10px 16px;

      background: var(--navy);

      color: var(--white);

      text-decoration: none;

      border-radius: 8px;

      font-weight: 500;

      font-size: 0.9em;

      transition: all 0.3s ease;

      margin-left: 20px;

      box-shadow: 0 4px 12px rgba(0, 31, 63, 0.15);

    }



    .home-btn:hover {

      background: var(--dark-navy);

      transform: translateY(-2px);

      box-shadow: 0 6px 20px rgba(0, 31, 63, 0.25);

    }



    nav {

      display: flex;

      align-items: center;

      margin-left: auto;

    }



    .menu-icon {

      display: none;

      font-size: 1.5em;

      color: var(--navy);

      cursor: pointer;

      background: none;

      border: none;

      padding: 10px;

      margin-left: auto;

      transition: all 0.3s ease;

      z-index: 1001;

    }



    .nav-links {

      display: flex;

      align-items: center;

      gap: clamp(15px, 2vw, 25px);

    }



    .nav-links a {

      text-decoration: none;

      color: var(--navy);

      font-weight: 500;

      font-size: 0.95em;

      transition: all 0.3s ease;

      white-space: nowrap;

      padding: 8px 16px;

      border-radius: 8px;

    }



    .nav-links a:hover {

      color: var(--creator);

      background: rgba(139, 92, 246, 0.08);

    }



    /* Theme Toggle Styles */

    .theme-toggle {

      background: none;

      border: none;

      color: var(--navy);

      cursor: pointer;

      padding: 10px;

      border-radius: 50%;

      transition: all 0.3s ease;

      display: flex;

      align-items: center;

      justify-content: center;

      width: 40px;

      height: 40px;

    }



    .theme-toggle:hover {

      background: rgba(139, 92, 246, 0.1);

      color: var(--creator);

    }



    /* Notification Bell Styles */

    .notification-bell {

      position: relative;

      padding: 8px 16px;

      text-decoration: none;

      color: var(--navy);

      font-weight: 500;

      transition: all 0.3s ease;

      border-radius: 8px;

    }



    .notification-bell:hover {

      color: var(--creator);

      background: rgba(139, 92, 246, 0.08);

    }



    .notification-indicator {

      position: absolute;

      top: 5px;

      right: 8px;

      background: var(--danger);

      color: white;

      border-radius: 50%;

      width: 18px;

      height: 18px;

      font-size: 0.7em;

      display: flex;

      align-items: center;

      justify-content: center;

      font-weight: bold;

      animation: pulse 2s infinite;

    }



    @keyframes pulse {

      0% { transform: scale(1); }

      50% { transform: scale(1.1); }

      100% { transform: scale(1); }

    }



    /* Dropdown Menu Styles */

    .user-dropdown {

      position: relative;

      display: inline-block;

    }



    .dropdown-btn {

      background: none;

      border: none;

      color: var(--navy);

      cursor: pointer;

      padding: 8px 16px;

      border-radius: 8px;

      transition: all 0.3s ease;

      display: flex;

      align-items: center;

      gap: 8px;

      font-weight: 500;

    }



    .dropdown-btn:hover {

      background: rgba(139, 92, 246, 0.08);

      color: var(--creator);

    }



    .dropdown-content {

      display: none;

      position: absolute;

      right: 0;

      top: 100%;

      background: white;

      min-width: 200px;

      box-shadow: var(--hover-shadow);

      border-radius: 12px;

      z-index: 1000;

      padding: 10px 0;

      border: 1px solid rgba(0, 31, 63, 0.1);

    }



    [data-theme="dark"] .dropdown-content {

      background: #2d3748;

      border: 1px solid rgba(255, 255, 255, 0.1);

    }



    .dropdown-content.show {

      display: block;

    }



    .dropdown-item {

      display: flex;

      align-items: center;

      gap: 10px;

      padding: 12px 20px;

      text-decoration: none;

      color: var(--navy);

      transition: all 0.3s ease;

      border: none;

      background: none;

      width: 100%;

      text-align: left;

      cursor: pointer;

      font-size: 0.9em;

    }



    [data-theme="dark"] .dropdown-item {

      color: #e2e8f0;

    }



    .dropdown-item:hover {

      background: rgba(139, 92, 246, 0.08);

      color: var(--creator);

    }



    .user-info {

      display: flex;

      align-items: center;

      gap: 12px;

      margin-left: 15px;

      padding-left: 15px;

      border-left: 1px solid rgba(0, 31, 63, 0.1);

    }



    [data-theme="dark"] .user-info {

      border-left: 1px solid rgba(255, 255, 255, 0.1);

    }



    .user-email {

      font-size: 0.85em;

      color: var(--navy);

      background: rgba(139, 92, 246, 0.1);

      padding: 8px 16px;

      border-radius: 20px;

      white-space: nowrap;

      overflow: hidden;

      text-overflow: ellipsis;

      max-width: 160px;

      font-weight: 500;

    }



    [data-theme="dark"] .user-email {

      color: #e2e8f0;

      background: rgba(139, 92, 246, 0.2);

    }



    .logout-btn {

      background: linear-gradient(135deg, var(--creator) 0%, #7C3AED 100%);

      color: var(--white);

      border: none;

      padding: 10px 20px;

      border-radius: 8px;

      cursor: pointer;

      font-weight: 600;

      font-size: 0.85em;

      transition: all 0.3s ease;

      white-space: nowrap;

      box-shadow: 0 4px 15px rgba(139, 92, 246, 0.3);

    }



    .logout-btn:hover {

      transform: translateY(-2px);

      box-shadow: 0 6px 20px rgba(139, 92, 246, 0.4);

    }



    .dashboard {

      padding: 40px 5%;

      max-width: 1400px;

      margin: 0 auto;

      flex: 1;

      width: 100%;

    }



    .dashboard-header {

      display: flex;

      justify-content: space-between;

      align-items: center;

      margin-bottom: 40px;

      flex-wrap: wrap;

      gap: 20px;

    }



    .dashboard-title {

      font-family: "Montserrat", sans-serif;

      font-size: clamp(2em, 5vw, 2.5em);

      color: var(--navy);

      font-weight: 800;

    }



    [data-theme="dark"] .dashboard-title {

      color: #e2e8f0;

    }



    /* Greeting Styles */

    .greeting {

      font-size: 1.2em;

      color: var(--navy);

      font-weight: 500;

      margin-top: 10px;

      width: 100%;

    }



    [data-theme="dark"] .greeting {

      color: #e2e8f0;

    }



    .quick-actions {

      display: flex;

      gap: 15px;

      flex-wrap: wrap;

    }



    /* TODAY'S EARNINGS SECTION */

    .today-earnings-section {

      background: var(--white);

      border-radius: 20px;

      padding: 30px;

      box-shadow: var(--card-shadow);

      margin-bottom: 25px;

      border: 1px solid rgba(0, 31, 63, 0.05);

      position: relative;

      overflow: hidden;

    }



    .today-earnings-section::before {

      content: '';

      position: absolute;

      top: 0;

      left: 0;

      width: 100%;

      height: 4px;

      background: linear-gradient(90deg, var(--creator), var(--navy));

    }



    .today-earnings-header {

      display: flex;

      justify-content: space-between;

      align-items: center;

      margin-bottom: 20px;

      flex-wrap: wrap;

      gap: 15px;

    }



    .today-earnings-title {

      font-size: 1.5em;

      font-weight: 700;

      color: var(--navy);

      display: flex;

      align-items: center;

      gap: 10px;

    }



    .today-earnings-refresh {

      background: none;

      border: none;

      color: var(--creator);

      cursor: pointer;

      font-size: 1.2em;

      transition: all 0.3s ease;

      padding: 8px;

      border-radius: 50%;

    }



    .today-earnings-refresh:hover {

      background: rgba(139, 92, 246, 0.1);

      transform: rotate(180deg);

    }



    .today-earnings-content {

      display: grid;

      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));

      gap: 20px;

      margin-bottom: 25px;

    }



    .today-earnings-card {

      text-align: center;

      padding: 20px;

      border-radius: 15px;

      background: #f8fafc;

      transition: all 0.3s ease;

    }



    [data-theme="dark"] .today-earnings-card {

      background: #2d3748;

    }



    .today-earnings-card:hover {

      transform: translateY(-3px);

      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);

    }



    .today-earnings-value {

      font-size: 2.2em;

      font-weight: 800;

      color: var(--creator);

      margin-bottom: 5px;

      line-height: 1;

    }



    .today-earnings-label {

      font-size: 0.9em;

      color: #64748b;

      font-weight: 500;

    }



    .earnings-change {

      display: flex;

      align-items: center;

      justify-content: center;

      gap: 5px;

      font-size: 0.85em;

      font-weight: 600;

      margin-top: 5px;

    }



    .earnings-change.positive {

      color: var(--success);

    }



    .earnings-change.negative {

      color: var(--danger);

    }



    .today-earnings-breakdown {

      display: grid;

      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));

      gap: 15px;

      margin-top: 20px;

    }



    .breakdown-item {

      display: flex;

      flex-direction: column;

      align-items: center;

      padding: 15px;

      background: rgba(139, 92, 246, 0.05);

      border-radius: 10px;

      border-left: 3px solid var(--creator);

    }



    .breakdown-value {

      font-size: 1.3em;

      font-weight: 700;

      color: var(--navy);

      margin-bottom: 5px;

    }



    [data-theme="dark"] .breakdown-value {

      color: #e2e8f0;

    }



    .breakdown-label {

      font-size: 0.8em;

      color: #64748b;

      font-weight: 500;

    }



    .stats-grid {

      display: grid;

      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));

      gap: 25px;

      margin-bottom: 40px;

    }



    .stat-card {

      background: var(--white);

      border-radius: 20px;

      padding: 30px;

      box-shadow: var(--card-shadow);

      transition: all 0.4s ease;

      border: 1px solid rgba(0, 31, 63, 0.05);

      position: relative;

      overflow: hidden;

    }



    [data-theme="dark"] .stat-card {

      border: 1px solid rgba(255, 255, 255, 0.05);

    }



    .stat-card::before {

      content: '';

      position: absolute;

      top: 0;

      left: 0;

      width: 100%;

      height: 4px;

      background: linear-gradient(90deg, var(--creator), var(--navy));

    }



    .stat-card:hover {

      transform: translateY(-5px);

      box-shadow: var(--hover-shadow);

    }



    .stat-value {

      font-size: 2.5em;

      font-weight: 700;

      color: var(--navy);

      margin-bottom: 10px;

      line-height: 1;

    }



    [data-theme="dark"] .stat-value {

      color: #e2e8f0;

    }



    .stat-label {

      font-size: 1em;

      color: #64748b;

      font-weight: 500;

    }



    [data-theme="dark"] .stat-label {

      color: #a0aec0;

    }



    .youtube-section {

      background: var(--white);

      border-radius: 20px;

      padding: 30px;

      box-shadow: var(--card-shadow);

      margin-bottom: 40px;

      border: 1px solid rgba(0, 31, 63, 0.05);

    }



    [data-theme="dark"] .youtube-section {

      border: 1px solid rgba(255, 255, 255, 0.05);

    }



    .youtube-header {

      display: flex;

      justify-content: space-between;

      align-items: center;

      margin-bottom: 25px;

      flex-wrap: wrap;

      gap: 15px;

    }



    .youtube-status {

      padding: 6px 12px;

      border-radius: 20px;

      font-size: 0.85em;

      font-weight: 600;

    }



    .youtube-status.connected {

      background: rgba(40, 167, 69, 0.1);

      color: var(--success);

    }



    .youtube-status.not-connected {

      background: rgba(108, 117, 125, 0.1);

      color: #6c757d;

    }



    .youtube-link-display {

      display: flex;

      align-items: center;

      gap: 10px;

      margin-bottom: 20px;

      padding: 15px;

      background: #f8fafc;

      border-radius: 10px;

      border: 1px solid #e2e8f0;

    }



    [data-theme="dark"] .youtube-link-display {

      background: #2d3748;

      border: 1px solid rgba(255, 255, 255, 0.1);

    }



    .youtube-icon {

      color: #FF0000;

      font-size: 1.5em;

    }



    .youtube-url {

      flex: 1;

      color: var(--navy);

      font-weight: 500;

      word-break: break-all;

    }



    [data-theme="dark"] .youtube-url {

      color: #e2e8f0;

    }



    .youtube-actions {

      display: flex;

      gap: 10px;

      flex-wrap: wrap;

    }



    .withdrawal-section {

      background: var(--white);

      border-radius: 20px;

      padding: 30px;

      box-shadow: var(--card-shadow);

      margin-bottom: 40px;

      border: 1px solid rgba(0, 31, 63, 0.05);

    }



    [data-theme="dark"] .withdrawal-section {

      border: 1px solid rgba(255, 255, 255, 0.05);

    }



    .withdrawal-header {

      display: flex;

      justify-content: space-between;

      align-items: center;

      margin-bottom: 25px;

      flex-wrap: wrap;

      gap: 15px;

    }



    .section-title {

      font-size: 1.5em;

      font-weight: 700;

      color: var(--navy);

    }



    [data-theme="dark"] .section-title {

      color: #e2e8f0;

    }



    .balance-display {

      font-size: 2em;

      font-weight: 700;

      color: var(--navy);

      margin-bottom: 20px;

    }



    [data-theme="dark"] .balance-display {

      color: #e2e8f0;

    }



    .withdrawal-actions {

      display: flex;

      gap: 15px;

      flex-wrap: wrap;

    }



    .paypal-section {

      background: var(--white);

      border-radius: 20px;

      padding: 30px;

      box-shadow: var(--card-shadow);

      margin-bottom: 40px;

      border: 1px solid rgba(0, 31, 63, 0.05);

    }



    [data-theme="dark"] .paypal-section {

      border: 1px solid rgba(255, 255, 255, 0.05);

    }



    .paypal-info {

      display: flex;

      justify-content: space-between;

      align-items: center;

      margin-bottom: 20px;

      flex-wrap: wrap;

      gap: 15px;

    }



    .paypal-email {

      font-size: 1.1em;

      font-weight: 600;

      color: var(--navy);

    }



    [data-theme="dark"] .paypal-email {

      color: #e2e8f0;

    }



    .paypal-status {

      padding: 6px 12px;

      border-radius: 20px;

      font-size: 0.85em;

      font-weight: 600;

    }



    .paypal-status.connected {

      background: rgba(40, 167, 69, 0.1);

      color: var(--success);

    }



    .paypal-status.not-connected {

      background: rgba(108, 117, 125, 0.1);

      color: #6c757d;

    }



    .btn {

      display: inline-flex;

      align-items: center;

      justify-content: center;

      padding: 12px 24px;

      border-radius: 12px;

      font-weight: 600;

      text-decoration: none;

      transition: all 0.4s ease;

      cursor: pointer;

      border: none;

      font-size: 0.95em;

      text-align: center;

      min-width: 140px;

    }



    .btn.main {

      background: linear-gradient(135deg, var(--navy) 0%, var(--dark-navy) 100%);

      color: var(--white);

      box-shadow: 0 8px 30px rgba(0, 31, 63, 0.2);

    }



    .btn.main:hover {

      transform: translateY(-3px);

      box-shadow: 0 12px 40px rgba(0, 31, 63, 0.3);

    }



    .btn.success {

      background: linear-gradient(135deg, var(--success) 0%, #218838 100%);

      color: white;

      box-shadow: 0 8px 25px rgba(40, 167, 69, 0.3);

    }



    .btn.success:hover {

      transform: translateY(-3px);

      box-shadow: 0 12px 35px rgba(40, 167, 69, 0.4);

    }



    .btn.outline {

      border: 2px solid var(--navy);

      color: var(--navy);

      background: transparent;

    }



    [data-theme="dark"] .btn.outline {

      border: 2px solid #e2e8f0;

      color: #e2e8f0;

    }



    .btn.outline:hover {

      background: var(--navy);

      color: var(--white);

      transform: translateY(-3px);

    }



    [data-theme="dark"] .btn.outline:hover {

      background: #e2e8f0;

      color: var(--navy);

    }



    .btn.youtube {

      background: #FF0000;

      color: white;

      display: flex;

      align-items: center;

      gap: 8px;

    }



    .btn.youtube:hover {

      background: #CC0000;

      transform: translateY(-3px);

    }



    .modal {

      display: none;

      position: fixed;

      top: 0;

      left: 0;

      width: 100%;

      height: 100%;

      background: rgba(0, 0, 0, 0.5);

      backdrop-filter: blur(5px);

      z-index: 2000;

      align-items: center;

      justify-content: center;

      padding: 20px;

    }



    .modal.active {

      display: flex;

    }



    .modal-content {

      background: white;

      border-radius: 20px;

      padding: 40px;

      max-width: 500px;

      width: 100%;

      box-shadow: 0 25px 50px rgba(0, 0, 0, 0.25);

      position: relative;

      animation: modalSlideIn 0.3s ease;

    }



    [data-theme="dark"] .modal-content {

      background: #2d3748;

    }



    @keyframes modalSlideIn {

      from { opacity: 0; transform: translateY(-20px); }

      to { opacity: 1; transform: translateY(0); }

    }



    .modal-header {

      display: flex;

      justify-content: space-between;

      align-items: center;

      margin-bottom: 25px;

    }



    .modal-title {

      font-size: 1.5em;

      font-weight: 700;

      color: var(--navy);

    }



    [data-theme="dark"] .modal-title {

      color: #e2e8f0;

    }



    .close-modal {

      background: none;

      border: none;

      font-size: 1.5em;

      cursor: pointer;

      color: #64748b;

      transition: color 0.3s ease;

    }



    .close-modal:hover {

      color: var(--navy);

    }



    [data-theme="dark"] .close-modal:hover {

      color: #e2e8f0;

    }



    .form-group {

      margin-bottom: 20px;

    }



    .form-label {

      display: block;

      margin-bottom: 8px;

      font-weight: 500;

      color: var(--navy);

    }



    [data-theme="dark"] .form-label {

      color: #e2e8f0;

    }



    .form-input {

      width: 100%;

      padding: 12px 16px;

      border: 2px solid #e2e8f0;

      border-radius: 10px;

      font-size: 1em;

      transition: all 0.3s ease;

      background: white;

      color: var(--navy);

    }



    [data-theme="dark"] .form-input {

      background: #4a5568;

      border: 2px solid #718096;

      color: #e2e8f0;

    }



    .form-input:focus {

      outline: none;

      border-color: var(--creator);

      box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.1);

    }



    .modal-actions {

      display: flex;

      gap: 15px;

      margin-top: 30px;

    }



    /* Enhanced Notifications Panel */

    .notifications-panel {

      position: fixed;

      top: 0;

      right: -400px;

      width: 100%;

      max-width: 380px;

      height: 100vh;

      background: white;

      box-shadow: -5px 0 30px rgba(0, 0, 0, 0.1);

      z-index: 1999;

      transition: right 0.3s ease;

      padding: 80px 25px 25px;

      overflow-y: auto;

    }



    [data-theme="dark"] .notifications-panel {

      background: #2d3748;

    }



    .notifications-panel.active {

      right: 0;

    }



    .notifications-header {

      display: flex;

      justify-content: space-between;

      align-items: center;

      margin-bottom: 25px;

      padding-bottom: 15px;

      border-bottom: 1px solid #e2e8f0;

    }



    [data-theme="dark"] .notifications-header {

      border-bottom: 1px solid #4a5568;

    }



    .notifications-title {

      font-size: 1.3em;

      font-weight: 700;

      color: var(--navy);

      display: flex;

      align-items: center;

      gap: 10px;

    }



    [data-theme="dark"] .notifications-title {

      color: #e2e8f0;

    }



    .notification-badge {

      background: var(--danger);

      color: white;

      border-radius: 10px;

      padding: 2px 8px;

      font-size: 0.8em;

      margin-left: 8px;

    }



    .notification-item {

      padding: 15px;

      border-radius: 10px;

      margin-bottom: 15px;

      background: #f8fafc;

      border-left: 4px solid var(--creator);

      cursor: pointer;

      transition: all 0.3s ease;

      position: relative;

    }



    [data-theme="dark"] .notification-item {

      background: #4a5568;

    }



    .notification-item:hover {

      background: rgba(139, 92, 246, 0.05);

      transform: translateX(5px);

    }



    .notification-item.unread {

      background: rgba(139, 92, 246, 0.08);

      border-left-color: var(--navy);

    }



    .notification-subject {

      font-weight: 600;

      margin-bottom: 5px;

      color: var(--navy);

      cursor: pointer;

      display: flex;

      justify-content: space-between;

      align-items: center;

    }



    [data-theme="dark"] .notification-subject {

      color: #e2e8f0;

    }



    .notification-message {

      font-size: 0.9em;

      color: #64748b;

      margin-bottom: 10px;

      display: none;

      padding-top: 10px;

      border-top: 1px solid rgba(0, 0, 0, 0.05);

    }



    [data-theme="dark"] .notification-message {

      color: #a0aec0;

      border-top: 1px solid rgba(255, 255, 255, 0.05);

    }



    .notification-message.expanded {

      display: block;

    }



    .notification-time {

      font-size: 0.8em;

      color: #94a3b8;

    }



    .notification-actions {

      position: absolute;

      top: 10px;

      right: 10px;

      display: flex;

      gap: 5px;

    }



    .notification-action {

      background: none;

      border: none;

      color: #64748b;

      cursor: pointer;

      padding: 5px;

      border-radius: 4px;

      transition: all 0.3s ease;

    }



    .notification-action:hover {

      background: rgba(0, 0, 0, 0.05);

      color: var(--navy);

    }



    [data-theme="dark"] .notification-action:hover {

      background: rgba(255, 255, 255, 0.1);

      color: #e2e8f0;

    }



    .notification-action.read-toggle {

      color: var(--success);

    }



    .notification-action.delete {

      color: var(--danger);

    }



    .clear-all-btn {

      background: var(--danger);

      color: white;

      border: none;

      padding: 8px 16px;

      border-radius: 6px;

      cursor: pointer;

      font-size: 0.85em;

      transition: all 0.3s ease;

    }



    .clear-all-btn:hover {

      background: #c82333;

    }



    .notification {

      position: fixed;

      top: 20px;

      right: 20px;

      padding: 15px 25px;

      border-radius: 10px;

      color: white;

      font-weight: 500;

      z-index: 10000;

      transform: translateX(150%);

      transition: transform 0.3s ease;

      max-width: 350px;

      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);

    }



    .notification.show {

      transform: translateX(0);

    }



    .notification.success {

      background: linear-gradient(135deg, var(--success), #20c997);

    }



    .notification.error {

      background: linear-gradient(135deg, var(--danger), #e83e8c);

    }



    .notification.info {

      background: linear-gradient(135deg, #17a2b8, #6f42c1);

    }



    .loading-text {

      text-align: center;

      padding: 40px;

      color: var(--navy);

    }



    [data-theme="dark"] .loading-text {

      color: #e2e8f0;

    }



    .loading-spinner {

      border: 4px solid #f3f3f3;

      border-top: 4px solid var(--creator);

      border-radius: 50%;

      width: 40px;

      height: 40px;

      animation: spin 1s linear infinite;

      margin: 0 auto 20px;

    }



    @keyframes spin {

      0% { transform: rotate(0deg); }

      100% { transform: rotate(360deg); }

    }



    .access-denied {

      text-align: center;

      padding: 80px 20px;

      max-width: 500px;

      margin: 0 auto;

    }



    .withdrawal-history-section {

      background: var(--white);

      border-radius: 20px;

      padding: 30px;

      box-shadow: var(--card-shadow);

      margin-bottom: 40px;

      border: 1px solid rgba(0, 31, 63, 0.05);

    }



    [data-theme="dark"] .withdrawal-history-section {

      border: 1px solid rgba(255, 255, 255, 0.05);

    }



    .history-header {

      display: flex;

      justify-content: space-between;

      align-items: center;

      margin-bottom: 25px;

      flex-wrap: wrap;

      gap: 15px;

    }



    .history-table {

      width: 100%;

      border-collapse: collapse;

      margin-top: 20px;

    }



    .history-table th,

    .history-table td {

      padding: 15px;

      text-align: left;

      border-bottom: 1px solid #e2e8f0;

    }



    [data-theme="dark"] .history-table th,

    [data-theme="dark"] .history-table td {

      border-bottom: 1px solid #4a5568;

    }



    .history-table th {

      background: #f8fafc;

      font-weight: 600;

      color: var(--navy);

      font-size: 0.9em;

    }



    [data-theme="dark"] .history-table th {

      background: #4a5568;

      color: #e2e8f0;

    }



    .status-badge {

      padding: 6px 12px;

      border-radius: 20px;

      font-size: 0.8em;

      font-weight: 600;

      display: inline-block;

    }



    .status-pending {

      background: rgba(255, 193, 7, 0.1);

      color: var(--warning);

    }



    .status-approved {

      background: rgba(40, 167, 69, 0.1);

      color: var(--success);

    }



    .status-rejected {

      background: rgba(220, 53, 69, 0.1);

      color: var(--danger);

    }



    .status-paid {

      background: rgba(0, 123, 255, 0.1);

      color: #007bff;

    }



    .empty-state {

      text-align: center;

      padding: 60px 20px;

      color: #64748b;

    }



    [data-theme="dark"] .empty-state {

      color: #a0aec0;

    }



    .empty-state-icon {

      font-size: 3em;

      margin-bottom: 15px;

      opacity: 0.5;

    }



    .filter-controls {

      display: flex;

      gap: 15px;

      margin-bottom: 20px;

      flex-wrap: wrap;

    }



    .filter-select {

      padding: 10px 15px;

      border: 2px solid #e2e8f0;

      border-radius: 8px;

      font-size: 0.9em;

      background: white;

      min-width: 150px;

      color: var(--navy);

    }



    [data-theme="dark"] .filter-select {

      background: #4a5568;

      border: 2px solid #718096;

      color: #e2e8f0;

    }



    .admin-notes {

      max-width: 200px;

      overflow: hidden;

      text-overflow: ellipsis;

      white-space: nowrap;

      cursor: pointer;

    }



    .admin-notes.expanded {

      white-space: normal;

      max-width: none;

      background: #f8f9fa;

      padding: 8px;

      border-radius: 4px;

    }



    [data-theme="dark"] .admin-notes.expanded {

      background: #4a5568;

    }



    .table-loading {

      text-align: center;

      padding: 40px;

    }



    /* Enhanced Tab System */

    .creator-tabs {

      display: flex;

      margin-bottom: 30px;

      border-bottom: 1px solid #e2e8f0;

      overflow-x: auto;

      -webkit-overflow-scrolling: touch;

      scrollbar-width: none;

    }



    [data-theme="dark"] .creator-tabs {

      border-bottom: 1px solid #4a5568;

    }



    .creator-tabs::-webkit-scrollbar {

      display: none;

    }



    .creator-tab {

      padding: 12px 24px;

      cursor: pointer;

      font-weight: 500;

      border-bottom: 3px solid transparent;

      transition: all 0.3s ease;

      white-space: nowrap;

      flex-shrink: 0;

      text-decoration: none;

      color: var(--navy);

      display: flex;

      align-items: center;

      gap: 8px;

      background: none;

      border: none;

      position: relative;

    }



    [data-theme="dark"] .creator-tab {

      color: #e2e8f0;

    }



    .creator-tab.active {

      color: var(--creator);

      border-bottom: 3px solid var(--creator);

    }



    .creator-tab:hover {

      color: var(--creator);

    }



    .tab-content {

      display: none;

    }



    .tab-content.active {

      display: block;

    }



    /* Enhanced Stats Cards */

    .stats-grid-enhanced {

      display: grid;

      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));

      gap: 20px;

      margin-bottom: 30px;

    }



    .stat-card-enhanced {

      background: var(--white);

      padding: 25px;

      border-radius: 15px;

      box-shadow: var(--card-shadow);

      text-align: center;

      transition: all 0.4s ease;

      border: 1px solid rgba(0, 31, 63, 0.05);

      position: relative;

      overflow: hidden;

    }



    [data-theme="dark"] .stat-card-enhanced {

      border: 1px solid rgba(255, 255, 255, 0.05);

    }



    .stat-card-enhanced::before {

      content: '';

      position: absolute;

      top: 0;

      left: 0;

      width: 100%;

      height: 4px;

      background: linear-gradient(90deg, var(--creator), var(--navy));

    }



    .stat-card-enhanced:hover {

      transform: translateY(-5px);

      box-shadow: var(--hover-shadow);

    }



    .stat-number-enhanced {

      font-size: 2.5em;

      font-weight: 700;

      color: var(--navy);

      margin-bottom: 5px;

      line-height: 1;

    }



    [data-theme="dark"] .stat-number-enhanced {

      color: #e2e8f0;

    }



    .stat-label-enhanced {

      color: #64748b;

      font-weight: 500;

    }



    [data-theme="dark"] .stat-label-enhanced {

      color: #a0aec0;

    }



    /* Monthly Statements */

    .monthly-balance-card {

      background: var(--white);

      border-radius: 15px;

      padding: 25px;

      box-shadow: var(--card-shadow);

      border: 1px solid #e2e8f0;

      transition: all 0.3s ease;

      position: relative;

      margin-bottom: 20px;

    }



    [data-theme="dark"] .monthly-balance-card {

      border: 1px solid #4a5568;

    }



    .monthly-balance-card.settled {

      border-left: 4px solid var(--success);

    }



    .monthly-balance-card.unsettled {

      border-left: 4px solid var(--warning);

    }



    .month-header {

      display: flex;

      justify-content: space-between;

      align-items: center;

      margin-bottom: 20px;

    }



    .month-name {

      font-size: 1.3em;

      font-weight: 600;

      color: var(--navy);

    }



    [data-theme="dark"] .month-name {

      color: #e2e8f0;

    }



    .month-stats-grid {

      display: grid;

      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));

      gap: 15px;

      margin-bottom: 15px;

    }



    .month-stat {

      text-align: center;

      padding: 15px;

      background: #f8fafc;

      border-radius: 10px;

    }



    [data-theme="dark"] .month-stat {

      background: #4a5568;

    }



    .month-stat-value {

      font-size: 1.4em;

      font-weight: 700;

      color: var(--navy);

      margin-bottom: 5px;

    }



    [data-theme="dark"] .month-stat-value {

      color: #e2e8f0;

    }



    .month-stat-label {

      font-size: 0.85em;

      color: #64748b;

      font-weight: 500;

    }



    [data-theme="dark"] .month-stat-label {

      color: #a0aec0;

    }



    .settings-section {

      background: var(--white);

      border-radius: 20px;

      padding: 30px;

      box-shadow: var(--card-shadow);

      margin-bottom: 30px;

      border: 1px solid rgba(0, 31, 63, 0.05);

    }



    [data-theme="dark"] .settings-section {

      border: 1px solid rgba(255, 255, 255, 0.05);

    }



    .settings-header {

      display: flex;

      justify-content: space-between;

      align-items: center;

      margin-bottom: 25px;

    }



    .settings-title {

      font-size: 1.5em;

      font-weight: 700;

      color: var(--navy);

    }



    [data-theme="dark"] .settings-title {

      color: #e2e8f0;

    }



    .analytics-chart {

      background: var(--white);

      border-radius: 15px;

      padding: 25px;

      box-shadow: var(--card-shadow);

      margin-bottom: 25px;

      height: 300px;

      display: flex;

      align-items: center;

      justify-content: center;

      border: 1px solid rgba(0, 31, 63, 0.05);

    }



    [data-theme="dark"] .analytics-chart {

      border: 1px solid rgba(255, 255, 255, 0.05);

    }



    .chart-placeholder {

      text-align: center;

      color: #64748b;

    }



    [data-theme="dark"] .chart-placeholder {

      color: #a0aec0;

    }



    .chart-placeholder i {

      font-size: 3em;

      margin-bottom: 15px;

      opacity: 0.5;

    }



    /* Notification Detail View Styles */

    .notification-detail {

      background: var(--white);

      border-radius: 15px;

      padding: 30px;

      box-shadow: var(--card-shadow);

      margin-bottom: 25px;

      border: 1px solid rgba(0, 31, 63, 0.05);

    }



    [data-theme="dark"] .notification-detail {

      border: 1px solid rgba(255, 255, 255, 0.05);

    }



    .notification-detail-header {

      display: flex;

      justify-content: space-between;

      align-items: flex-start;

      margin-bottom: 20px;

      flex-wrap: wrap;

      gap: 15px;

    }



    .notification-detail-title {

      font-size: 1.5em;

      font-weight: 700;

      color: var(--navy);

      flex: 1;

    }



    [data-theme="dark"] .notification-detail-title {

      color: #e2e8f0;

    }



    .notification-detail-time {

      color: #64748b;

      font-size: 0.9em;

    }



    [data-theme="dark"] .notification-detail-time {

      color: #a0aec0;

    }



    .notification-detail-content {

      padding: 20px;

      background: #f8fafc;

      border-radius: 10px;

      line-height: 1.6;

      margin-bottom: 20px;

    }



    [data-theme="dark"] .notification-detail-content {

      background: #4a5568;

    }



    .notification-detail-actions {

      display: flex;

      gap: 10px;

      flex-wrap: wrap;

    }



    .notification-navigation {

      display: flex;

      justify-content: space-between;

      margin-top: 30px;

      padding-top: 20px;

      border-top: 1px solid #e2e8f0;

    }



    [data-theme="dark"] .notification-navigation {

      border-top: 1px solid #4a5568;

    }



    /* NEW: Video Performance Styles */

    .video-performance-grid {

      display: grid;

      grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));

      gap: 20px;

      margin-bottom: 30px;

    }



    .video-performance-card {

      background: var(--white);

      border-radius: 15px;

      padding: 20px;

      box-shadow: var(--card-shadow);

      transition: all 0.3s ease;

      border: 1px solid rgba(0, 31, 63, 0.05);

      position: relative;

      overflow: hidden;

    }



    [data-theme="dark"] .video-performance-card {

      border: 1px solid rgba(255, 255, 255, 0.05);

    }



    .video-performance-card:hover {

      transform: translateY(-5px);

      box-shadow: var(--hover-shadow);

    }



    .video-thumbnail {

      width: 100%;

      height: 180px;

      border-radius: 10px;

      overflow: hidden;

      margin-bottom: 15px;

      background: #f8fafc;

      display: flex;

      align-items: center;

      justify-content: center;

      position: relative;

    }



    .video-thumbnail img {

      width: 100%;

      height: 100%;

      object-fit: cover;

    }



    .video-thumbnail-placeholder {

      color: #64748b;

      text-align: center;

      padding: 20px;

    }



    .video-thumbnail-placeholder i {

      font-size: 2em;

      margin-bottom: 10px;

      opacity: 0.5;

    }



    .video-details {

      margin-bottom: 15px;

    }



    .video-title {

      font-size: 1.1em;

      font-weight: 600;

      color: var(--navy);

      margin-bottom: 8px;

      line-height: 1.4;

      display: -webkit-box;

      -webkit-line-clamp: 2;

      -webkit-box-orient: vertical;

      overflow: hidden;

    }



    [data-theme="dark"] .video-title {

      color: #e2e8f0;

    }



    .video-meta {

      display: flex;

      gap: 15px;

      margin-bottom: 10px;

      flex-wrap: wrap;

    }



    .meta-item {

      display: flex;

      align-items: center;

      gap: 5px;

      font-size: 0.85em;

      color: #64748b;

    }



    [data-theme="dark"] .meta-item {

      color: #a0aec0;

    }



    .video-stats {

      display: grid;

      grid-template-columns: repeat(2, 1fr);

      gap: 10px;

      margin-bottom: 15px;

    }



    .video-stat {

      text-align: center;

      padding: 12px;

      background: #f8fafc;

      border-radius: 8px;

    }



    [data-theme="dark"] .video-stat {

      background: #4a5568;

    }



    .video-stat-value {

      font-size: 1.2em;

      font-weight: 700;

      color: var(--navy);

      margin-bottom: 3px;

    }



    [data-theme="dark"] .video-stat-value {

      color: #e2e8f0;

    }



    .video-stat-label {

      font-size: 0.75em;

      color: #64748b;

      font-weight: 500;

    }



    [data-theme="dark"] .video-stat-label {

      color: #a0aec0;

    }



    .video-earnings {

      background: rgba(139, 92, 246, 0.08);

      border-radius: 10px;

      padding: 15px;

      text-align: center;

      border-left: 4px solid var(--creator);

    }



    .video-earnings-label {

      font-size: 0.85em;

      color: #64748b;

      margin-bottom: 5px;

    }



    [data-theme="dark"] .video-earnings-label {

      color: #a0aec0;

    }



    .video-earnings-value {

      font-size: 1.4em;

      font-weight: 700;

      color: var(--creator);

    }



    .video-assignment-date {

      text-align: center;

      font-size: 0.8em;

      color: #64748b;

      margin-top: 10px;

    }



    [data-theme="dark"] .video-assignment-date {

      color: #a0aec0;

    }



    /* Monthly Reports Styles */

    .monthly-reports-grid {

      display: grid;

      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));

      gap: 20px;

      margin-bottom: 30px;

    }



    .monthly-report-card {

      background: var(--white);

      border-radius: 15px;

      padding: 25px;

      box-shadow: var(--card-shadow);

      transition: all 0.3s ease;

      border: 1px solid #e2e8f0;

      position: relative;

    }



    [data-theme="dark"] .monthly-report-card {

      border: 1px solid #4a5568;

    }



    .monthly-report-card.settled {

      border-left: 4px solid var(--success);

    }



    .monthly-report-card.unsettled {

      border-left: 4px solid var(--warning);

    }



    .monthly-report-card:hover {

      transform: translateY(-3px);

      box-shadow: var(--hover-shadow);

    }



    .report-header {

      display: flex;

      justify-content: space-between;

      align-items: center;

      margin-bottom: 20px;

    }



    .report-month {

      font-size: 1.2em;

      font-weight: 600;

      color: var(--navy);

    }



    [data-theme="dark"] .report-month {

      color: #e2e8f0;

    }



    .report-status {

      padding: 6px 12px;

      border-radius: 20px;

      font-size: 0.8em;

      font-weight: 600;

    }



    .report-status.settled {

      background: rgba(40, 167, 69, 0.1);

      color: var(--success);

    }



    .report-status.unsettled {

      background: rgba(255, 193, 7, 0.1);

      color: var(--warning);

    }



    .report-stats {

      display: grid;

      grid-template-columns: repeat(2, 1fr);

      gap: 15px;

      margin-bottom: 20px;

    }



    .report-stat {

      text-align: center;

      padding: 15px;

      background: #f8fafc;

      border-radius: 10px;

    }



    [data-theme="dark"] .report-stat {

      background: #4a5568;

    }



    .report-stat-value {

      font-size: 1.3em;

      font-weight: 700;

      color: var(--navy);

      margin-bottom: 5px;

    }



    [data-theme="dark"] .report-stat-value {

      color: #e2e8f0;

    }



    .report-stat-label {

      font-size: 0.8em;

      color: #64748b;

      font-weight: 500;

    }



    [data-theme="dark"] .report-stat-label {

      color: #a0aec0;

    }



    .report-earnings {

      background: rgba(139, 92, 246, 0.08);

      border-radius: 10px;

      padding: 15px;

      text-align: center;

      margin-bottom: 15px;

    }



    .report-earnings-label {

      font-size: 0.9em;

      color: #64748b;

      margin-bottom: 5px;

    }



    [data-theme="dark"] .report-earnings-label {

      color: #a0aec0;

    }



    .report-earnings-value {

      font-size: 1.6em;

      font-weight: 700;

      color: var(--creator);

    }



    .report-date {

      text-align: center;

      font-size: 0.8em;

      color: #64748b;

    }



    [data-theme="dark"] .report-date {

      color: #a0aec0;

    }



    /* Footer Styles */

    footer {

      background: var(--navy);

      color: var(--white);

      padding: 40px 5%;

      margin-top: auto;

    }



    .footer-content {

      max-width: 1200px;

      margin: 0 auto;

      display: flex;

      justify-content: space-between;

      align-items: center;

      flex-wrap: wrap;

      gap: 20px;

    }



    .footer-left {

      display: flex;

      flex-direction: column;

      gap: 10px;

    }



    .footer-copyright {

      font-size: 0.9em;

      opacity: 0.8;

    }



    .support-email {

      color: var(--light-gold);

      text-decoration: none;

      font-weight: 500;

      transition: all 0.3s ease;

      display: inline-flex;

      align-items: center;

      gap: 8px;

    }



    .support-email:hover {

      color: var(--gold);

      transform: translateY(-2px);

    }



    .footer-right {

      display: flex;

      gap: 15px;

    }



    .social-link {

      color: var(--white);

      font-size: 1.2em;

      transition: all 0.3s ease;

      opacity: 0.8;

    }



    .social-link:hover {

      color: var(--gold);

      transform: translateY(-2px);

      opacity: 1;

    }



    /* Auto Logout Warning Modal */

    .logout-warning-modal {

      display: none;

      position: fixed;

      top: 0;

      left: 0;

      width: 100%;

      height: 100%;

      background: rgba(0, 0, 0, 0.7);

      backdrop-filter: blur(10px);

      z-index: 3000;

      align-items: center;

      justify-content: center;

      padding: 20px;

    }



    .logout-warning-modal.active {

      display: flex;

    }



    .logout-warning-content {

      background: white;

      border-radius: 20px;

      padding: 40px;

      max-width: 500px;

      width: 100%;

      box-shadow: 0 25px 50px rgba(0, 0, 0, 0.3);

      text-align: center;

      animation: modalSlideIn 0.3s ease;

    }



    [data-theme="dark"] .logout-warning-content {

      background: #2d3748;

    }



    .logout-warning-icon {

      font-size: 4em;

      color: var(--warning);

      margin-bottom: 20px;

    }



    .logout-warning-title {

      font-size: 1.8em;

      font-weight: 700;

      color: var(--navy);

      margin-bottom: 15px;

    }



    [data-theme="dark"] .logout-warning-title {

      color: #e2e8f0;

    }



    .logout-warning-message {

      color: #64748b;

      margin-bottom: 30px;

      line-height: 1.6;

    }



    [data-theme="dark"] .logout-warning-message {

      color: #a0aec0;

    }



    .logout-timer {

      font-size: 2em;

      font-weight: 700;

      color: var(--danger);

      margin: 20px 0;

    }



    .logout-warning-actions {

      display: flex;

      gap: 15px;

      justify-content: center;

      margin-top: 25px;

    }



    /* Chart Styles */

    .chart-container {

      position: relative;

      height: 100%;

      width: 100%;

    }



    .chart-controls {

      display: flex;

      justify-content: space-between;

      align-items: center;

      margin-bottom: 20px;

      flex-wrap: wrap;

      gap: 15px;

    }



    .chart-period-selector {

      display: flex;

      gap: 10px;

      flex-wrap: wrap;

    }



    .period-btn {

      padding: 8px 16px;

      border: 1px solid #e2e8f0;

      border-radius: 6px;

      background: white;

      color: var(--navy);

      cursor: pointer;

      font-size: 0.85em;

      transition: all 0.3s ease;

    }



    [data-theme="dark"] .period-btn {

      background: #4a5568;

      border: 1px solid #718096;

      color: #e2e8f0;

    }



    .period-btn.active {

      background: var(--creator);

      color: white;

      border-color: var(--creator);

    }



    .chart-export-btn {

      padding: 8px 16px;

      border: 1px solid var(--creator);

      border-radius: 6px;

      background: transparent;

      color: var(--creator);

      cursor: pointer;

      font-size: 0.85em;

      transition: all 0.3s ease;

      display: flex;

      align-items: center;

      gap: 5px;

    }



    .chart-export-btn:hover {

      background: var(--creator);

      color: white;

    }



    @media (max-width: 768px) {

      header {

        padding: 15px 4%;

        min-height: 70px;

      }



      .brand {

        position: static;

        transform: none;

        margin: 0 auto;

      }



      .home-btn {

        margin-left: 10px;

        padding: 8px 12px;

        font-size: 0.8em;

      }



      .menu-icon {

        display: block;

      }



      .nav-links {

        display: none;

        flex-direction: column;

        background: rgba(255, 255, 255, 0.98);

        backdrop-filter: blur(20px);

        position: fixed;

        top: 0;

        left: 0;

        width: 85%;

        height: 100vh;

        box-shadow: 10px 0 50px rgba(0, 0, 0, 0.1);

        padding: 100px 30px 40px;

        z-index: 999;

        gap: 0;

      }



      [data-theme="dark"] .nav-links {

        background: rgba(26, 26, 26, 0.98);

      }



      .nav-links.show {

        display: flex;

      }



      .nav-links a {

        padding: 18px 0;

        border-bottom: 1px solid rgba(0, 31, 63, 0.05);

        font-size: 1.1em;

        width: 100%;

        border-radius: 0;

      }



      [data-theme="dark"] .nav-links a {

        border-bottom: 1px solid rgba(255, 255, 255, 0.05);

      }



      .user-info {

        flex-direction: column;

        gap: 20px;

        margin: 30px 0 0 0;

        width: 100%;

        align-items: stretch;

        border-left: none;

        border-top: 1px solid rgba(0, 31, 63, 0.05);

        padding: 20px 0 0 0;

      }



      [data-theme="dark"] .user-info {

        border-top: 1px solid rgba(255, 255, 255, 0.05);

      }



      .dashboard-header {

        flex-direction: column;

        align-items: flex-start;

      }



      .quick-actions {

        width: 100%;

        justify-content: space-between;

      }



      .btn {

        flex: 1;

        min-width: 120px;

      }



      .stats-grid {

        grid-template-columns: 1fr;

      }



      .modal-content {

        padding: 30px 20px;

      }



      .history-table {

        display: block;

        overflow-x: auto;

      }



      .filter-controls {

        flex-direction: column;

      }



      .filter-select {

        width: 100%;

      }



      .creator-tabs {

        margin-bottom: 20px;

      }



      .creator-tab {

        padding: 12px 18px;

        font-size: 0.9em;

      }



      .stats-grid-enhanced {

        grid-template-columns: 1fr;

        gap: 15px;

      }



      .month-stats-grid {

        grid-template-columns: repeat(2, 1fr);

        gap: 10px;

      }



      .month-stat {

        padding: 12px;

      }



      .month-stat-value {

        font-size: 1.2em;

      }



      /* NEW: Mobile Responsive Video Performance */

      .video-performance-grid {

        grid-template-columns: 1fr;

        gap: 15px;

      }



      .video-performance-card {

        padding: 15px;

      }



      .video-thumbnail {

        height: 150px;

      }



      .video-stats {

        grid-template-columns: repeat(2, 1fr);

        gap: 8px;

      }



      .video-stat {

        padding: 10px;

      }



      .video-stat-value {

        font-size: 1.1em;

      }



      /* NEW: Mobile Responsive Monthly Reports */

      .monthly-reports-grid {

        grid-template-columns: 1fr;

        gap: 15px;

      }



      .monthly-report-card {

        padding: 20px;

      }



      .report-stats {

        grid-template-columns: repeat(2, 1fr);

        gap: 10px;

      }



      .report-stat {

        padding: 12px;

      }



      .report-stat-value {

        font-size: 1.1em;

      }



      /* TODAY'S EARNINGS MOBILE STYLES */

      .today-earnings-content {

        grid-template-columns: 1fr;

        gap: 15px;

      }



      .today-earnings-card {

        padding: 15px;

      }



      .today-earnings-value {

        font-size: 1.8em;

      }



      .today-earnings-breakdown {

        grid-template-columns: repeat(2, 1fr);

        gap: 10px;

      }



      .breakdown-item {

        padding: 12px;

      }



      .breakdown-value {

        font-size: 1.1em;

      }



      .footer-content {

        flex-direction: column;

        text-align: center;

        gap: 30px;

      }



      .footer-left {

        align-items: center;

      }



      .logout-warning-actions {

        flex-direction: column;

      }



      .chart-controls {

        flex-direction: column;

        align-items: flex-start;

      }

      

      .chart-period-selector {

        width: 100%;

        justify-content: space-between;

      }

      

      .period-btn {

        flex: 1;

        text-align: center;

      }

    }

  </style>

</head>



<body>

  <!-- Auto Logout Warning Modal -->

  <div class="logout-warning-modal" id="logoutWarningModal">

    <div class="logout-warning-content">

      <div class="logout-warning-icon">

        <i class="fas fa-clock"></i>

      </div>

      <h2 class="logout-warning-title">Session Timeout Warning</h2>

      <p class="logout-warning-message">

        Your session will expire due to inactivity in <span class="logout-timer" id="logoutTimer">10:00</span> seconds.

        Would you like to continue your session?

      </p>

      <div class="logout-warning-actions">

        <button class="btn success" onclick="extendSession()">

          <i class="fas fa-sync-alt"></i> Continue Session

        </button>

        <button class="btn outline" onclick="logout()">

          <i class="fas fa-sign-out-alt"></i> Log Out Now

        </button>

      </div>

    </div>

  </div>



  <!-- Notification System -->

  <div id="notification" class="notification"></div>



  <!-- Enhanced Notifications Panel -->

  <div class="notifications-panel" id="notificationsPanel">

    <div class="notifications-header">

      <h3 class="notifications-title">

        <i class="fas fa-bell"></i> Notifications

        <span class="notification-badge" id="notificationCountBadge" style="display: none;"></span>

      </h3>

      <div>

        <button class="clear-all-btn" onclick="clearAllNotifications()">

          <i class="fas fa-trash"></i> Clear All

        </button>

        <button class="close-modal" onclick="closeNotifications()"><i class="fas fa-times"></i></button>

      </div>

    </div>

    <div id="notificationsList">

      <!-- Notifications will be populated here -->

    </div>

  </div>



  <!-- Withdrawal Modal -->

  <div class="modal" id="withdrawalModal">

    <div class="modal-content">

      <div class="modal-header">

        <h3 class="modal-title">Request Withdrawal</h3>

        <button class="close-modal" onclick="closeModal('withdrawalModal')"><i class="fas fa-times"></i></button>

      </div>

      <div class="form-group">

        <label class="form-label">Available Balance</label>

        <div class="balance-display" id="modalBalance">$0.00</div>

      </div>

      <div class="form-group">

        <label class="form-label">Withdrawal Amount ($)</label>

        <input type="number" class="form-input" id="withdrawalAmount" placeholder="Enter amount" min="10" step="0.01">

      </div>

      <div class="form-group">

        <label class="form-label">PayPal Email</label>

        <input type="email" class="form-input" id="paypalEmail" placeholder="Your PayPal email">

      </div>

      <div class="modal-actions">

        <button class="btn outline" onclick="closeModal('withdrawalModal')">Cancel</button>

        <button class="btn success" onclick="requestWithdrawal()">Request Withdrawal</button>

      </div>

    </div>

  </div>



  <!-- PayPal Settings Modal -->

  <div class="modal" id="paypalModal">

    <div class="modal-content">

      <div class="modal-header">

        <h3 class="modal-title">PayPal Settings</h3>

        <button class="close-modal" onclick="closeModal('paypalModal')"><i class="fas fa-times"></i></button>

      </div>

      <div class="form-group">

        <label class="form-label">PayPal Email</label>

        <input type="email" class="form-input" id="paypalSettingsEmail" placeholder="Your PayPal email">

      </div>

      <div class="form-group">

        <label class="form-label">Confirm PayPal Email</label>

        <input type="email" class="form-input" id="paypalConfirmEmail" placeholder="Confirm your PayPal email">

      </div>

      <div class="modal-actions">

        <button class="btn outline" onclick="closeModal('paypalModal')">Cancel</button>

        <button class="btn main" onclick="savePayPalSettings()">Save Settings</button>

      </div>

    </div>

  </div>



  <!-- YouTube Channel Modal -->

  <div class="modal" id="youtubeModal">

    <div class="modal-content">

      <div class="modal-header">

        <h3 class="modal-title">Add YouTube Channel</h3>

        <button class="close-modal" onclick="closeModal('youtubeModal')"><i class="fas fa-times"></i></button>

      </div>

      <div class="form-group">

        <label class="form-label">YouTube Channel URL</label>

        <input type="url" class="form-input" id="youtubeChannelUrl" placeholder="https://youtube.com/c/yourchannel">

        <small style="color: #64748b; margin-top: 5px; display: block;">

          Paste your full YouTube channel URL

        </small>

      </div>

      <div class="form-group">

        <label class="form-label">Channel Name (Optional)</label>

        <input type="text" class="form-input" id="channelName" placeholder="Your channel name">

      </div>

      <div class="modal-actions">

        <button class="btn outline" onclick="closeModal('youtubeModal')">Cancel</button>

        <button class="btn youtube" onclick="saveYouTubeChannel()">

          <i class="fab fa-youtube"></i> Save Channel

        </button>

      </div>

    </div>

  </div>



  <!-- Header -->

  <header>

    <button class="menu-icon" onclick="toggleMenu()"><i class="fas fa-bars"></i></button>

    <div class="brand">EVERNET</div>

    <a href="/" class="home-btn">

      <i class="fas fa-home"></i> Home

    </a>

    <nav>

      <div class="nav-links" id="navMenu">

        <button class="theme-toggle" onclick="toggleTheme()" title="Toggle theme">

          <i class="fas fa-moon"></i>

        </button>

        <a href="javascript:void(0)" onclick="toggleNotifications()" class="notification-bell">

          <i class="fas fa-bell"></i>

          <span class="notification-indicator" id="headerNotificationCount" style="display: none;"></span>

        </a>

        <div class="user-info" id="userInfo" style="display: none;">

          <span class="user-email" id="userEmail"></span>

          

          <div class="user-dropdown">

            <button class="dropdown-btn" onclick="toggleDropdown()">

              <i class="fas fa-cog"></i> Settings <i class="fas fa-chevron-down"></i>

            </button>

            <div class="dropdown-content" id="settingsDropdown">

              <button class="dropdown-item" onclick="switchCreatorTab('settings')">

                <i class="fas fa-user-cog"></i> Profile Settings

              </button>

              <button class="dropdown-item" onclick="openModal('paypalModal')">

                <i class="fab fa-paypal"></i> PayPal Settings

              </button>

              <button class="dropdown-item" onclick="openModal('passwordModal')">

                <i class="fas fa-key"></i> Change Password

              </button>

              <hr style="margin: 5px 0; border: none; border-top: 1px solid #e2e8f0;">

              <button class="dropdown-item" onclick="logout()" style="color: var(--danger);">

                <i class="fas fa-sign-out-alt"></i> Sign Out

              </button>

            </div>

          </div>

        </div>

      </div>

    </nav>

  </header>



  <!-- Dashboard Content -->

  <div class="dashboard">

    <!-- Access Denied Screen -->

    <div id="accessDenied" class="access-denied" style="display: none;">

      <h2>Access Denied</h2>

      <p>You must be logged in to access the creator dashboard.</p>

      <button class="btn main" onclick="redirectToLogin()">Go to Login</button>

    </div>



    <!-- Dashboard Content (Only shown when authenticated) -->

    <div id="dashboardContent" style="display: none;">

      <!-- Dashboard Header -->

      <div class="dashboard-header">

        <h1 class="dashboard-title">Creator Dashboard</h1>

        <div class="greeting" id="greetingText">

          Good morning, Creator!

        </div>

        <div class="quick-actions">

          <button class="btn success" onclick="refreshStats()"><i class="fas fa-sync-alt"></i> Refresh</button>

          <button class="btn main" onclick="openModal('withdrawalModal')"><i class="fas fa-money-bill-wave"></i> Withdraw</button>

        </div>

      </div>



      

      <!-- ENHANCED TAB SYSTEM WITH REORDERED TABS -->

      <div class="creator-tabs">

        <button class="creator-tab" onclick="switchCreatorTab('notifications')">

          <i class="fas fa-bell"></i> Notifications

          <span class="notification-indicator" id="tabNotificationCount" style="display: none;"></span>

        </button>

        <a href="/music/" class="creator-tab">

          <i class="fas fa-music"></i> Music

        </a>

        <button class="creator-tab" onclick="switchCreatorTab('videos')">

          <i class="fas fa-play-circle"></i> Video Performance

        </button>

        <button class="creator-tab active" onclick="switchCreatorTab('overview')">

          <i class="fas fa-tachometer-alt"></i> Overview

        </button>

        <button class="creator-tab" onclick="switchCreatorTab('earnings')">

          <i class="fas fa-chart-line"></i> Earnings

        </button>

        <button class="creator-tab" onclick="switchCreatorTab('withdrawals')">

          <i class="fas fa-money-bill-wave"></i> Withdrawals

        </button>

        <button class="creator-tab" onclick="switchCreatorTab('monthly')">

          <i class="fas fa-calendar-alt"></i> Monthly

        </button>

      </div>



      <!-- Loading State -->

      <div id="loadingState" class="loading-text">

        <div class="loading-spinner"></div>

        <p>Loading your dashboard data...</p>

      </div>



      <!-- Main Dashboard Content with Tabs -->

      <div id="mainDashboardContent" style="display: none;">

        

        <!-- TAB 1: NOTIFICATIONS (NOW FIRST TAB) -->

        <div id="notificationsTab" class="tab-content">

          <div class="settings-section">

            <div class="settings-header">

              <h3 class="settings-title">Notifications</h3>

              <div class="notification-actions">

                <button class="btn outline" onclick="markAllAsRead()">

                  <i class="fas fa-check-double"></i> Mark All as Read

                </button>

                <button class="btn danger" onclick="clearAllNotifications()">

                  <i class="fas fa-trash"></i> Clear All

                </button>

              </div>

            </div>

            

            <!-- Notification Detail View (Initially Hidden) -->

            <div id="notificationDetailView" style="display: none;">

              <div class="notification-detail">

                <div class="notification-detail-header">

                  <h3 class="notification-detail-title" id="detailTitle">Notification Title</h3>

                  <div class="notification-detail-time" id="detailTime"></div>

                </div>

                <div class="notification-detail-content" id="detailContent">

                  Notification content will appear here.

                </div>

                <div class="notification-detail-actions">

                  <button class="btn outline" onclick="toggleReadStatus(currentNotificationId)" id="readToggleBtn">

                    <i class="fas fa-check"></i> Mark as Read

                  </button>

                  <button class="btn danger" onclick="deleteNotification(currentNotificationId)">

                    <i class="fas fa-trash"></i> Delete

                  </button>

                  <button class="btn main" onclick="showNotificationListView()">

                    <i class="fas fa-arrow-left"></i> Back to List

                  </button>

                </div>

                <div class="notification-navigation">

                  <button class="btn outline" onclick="showPreviousNotification()" id="prevBtn">

                    <i class="fas fa-chevron-left"></i> Previous

                  </button>

                  <button class="btn outline" onclick="showNextNotification()" id="nextBtn">

                    Next <i class="fas fa-chevron-right"></i>

                  </button>

                </div>

              </div>

            </div>

            

            <!-- Notification List View -->

            <div id="notificationListView">

              <div class="filter-controls">

                <select class="filter-select" id="notificationFilter" onchange="filterNotifications()">

                  <option value="all">All Notifications</option>

                  <option value="unread">Unread Only</option>

                  <option value="read">Read Only</option>

                </select>

                <select class="filter-select" id="notificationTypeFilter" onchange="filterNotifications()">

                  <option value="all">All Types</option>

                  <option value="system">System</option>

                  <option value="payment">Payment</option>

                  <option value="withdrawal">Withdrawal</option>

                  <option value="update">Update</option>

                </select>

              </div>

              <div id="notificationsTabList">

                <div class="empty-state">

                  <div class="empty-state-icon"><i class="fas fa-bell"></i></div>

                  <p>No notifications yet</p>

                  <p style="font-size: 0.9em; margin-top: 10px;">You're all caught up!</p>

                </div>

              </div>

            </div>

          </div>

        </div>



        <!-- TAB 2: MUSIC (REDIRECTS TO EXTERNAL PAGE) -->

        <!-- This tab is handled by the link in the tab system -->



        <!-- TAB 3: VIDEO PERFORMANCE -->

        <div id="videosTab" class="tab-content">

          <div class="settings-section">

            <div class="settings-header">

              <h3 class="settings-title">Your Shorts Performance</h3>

              <button class="btn outline" onclick="loadVideosData()">

                <i class="fas fa-sync-alt"></i> Refresh

              </button>

            </div>

            

            <!-- Video Stats Overview -->

            <div class="stats-grid-enhanced" style="margin-bottom: 30px;">

              <div class="stat-card-enhanced">

                <div class="stat-number-enhanced" id="totalVideosCount">0</div>

                <div class="stat-label-enhanced">Total Shorts</div>

              </div>

              <div class="stat-card-enhanced">

                <div class="stat-number-enhanced" id="totalVideoViews">0</div>

                <div class="stat-label-enhanced">Total Views</div>

              </div>

              <div class="stat-card-enhanced">

                <div class="stat-number-enhanced" id="totalVideoEarnings">$0.00</div>

                <div class="stat-label-enhanced">Total Earnings</div>

              </div>

              <div class="stat-card-enhanced">

                <div class="stat-number-enhanced" id="avgRPM">$0.00</div>

                <div class="stat-label-enhanced">Avg. RPM</div>

              </div>

            </div>



            <!-- Videos List -->

            <div id="videosListContainer">

              <div class="filter-controls">

                <select class="filter-select" id="videoSortFilter" onchange="filterVideos()">

                  <option value="newest">Newest First</option>

                  <option value="oldest">Oldest First</option>

                  <option value="highestEarnings">Highest Earnings</option>

                  <option value="mostViews">Most Views</option>

                </select>

                <input type="text" class="filter-select" id="videoSearch" placeholder="Search videos..." onkeyup="filterVideos()">

              </div>

              

              <div id="videosList">

                <div class="empty-state">

                  <div class="empty-state-icon"><i class="fas fa-play-circle"></i></div>

                  <p>No videos found</p>

                  <p style="font-size: 0.9em; margin-top: 10px;">Your scanned YouTube Shorts will appear here</p>

                </div>

              </div>

            </div>

          </div>

        </div>



<!-- TAB 4: OVERVIEW (NOW FOURTH TAB) -->

<div id="overviewTab" class="tab-content active">

  <!-- TODAY'S EARNINGS SECTION - SIMPLIFIED -->

  <div class="today-earnings-section">

    <div class="today-earnings-header">

      <h3 class="today-earnings-title">

        <i class="fas fa-chart-line"></i> Today's Performance

      </h3>

      <button class="today-earnings-refresh" onclick="refreshTodayEarnings()" title="Refresh earnings">

        <i class="fas fa-sync-alt"></i>

      </button>

    </div>

    

    <div class="today-earnings-content">

      <div class="today-earnings-card">

        <div class="today-earnings-value" id="todayEarnings">$0.00</div>

        <div class="today-earnings-label">Total Earnings Today</div>

        <div class="earnings-change" id="todayChange">

          <i class="fas fa-caret-up"></i>

          <span>+$0.00</span>

        </div>

      </div>

      

      <div class="today-earnings-card">

        <div class="today-earnings-value" id="todayViews">0</div>

        <div class="today-earnings-label">Views Today</div>

        <div class="earnings-change" id="viewsChange">

          <i class="fas fa-caret-up"></i>

          <span>+0</span>

        </div>

      </div>

      

      <div class="today-earnings-card">

        <div class="today-earnings-value" id="todayVideos">0</div>

        <div class="today-earnings-label">Shorts Today</div>

        <div class="earnings-change" id="videosChange">

          <i class="fas fa-caret-up"></i>

          <span>+0</span>

        </div>

      </div>

    </div>

  </div>



  <!-- Enhanced Stats Grid -->

  <div class="stats-grid-enhanced">

    <div class="stat-card-enhanced">

      <div class="stat-number-enhanced" id="totalViewsEnhanced">0</div>

      <div class="stat-label-enhanced">Total Views</div>

    </div>

    <div class="stat-card-enhanced">

      <div class="stat-number-enhanced" id="premiumViewsEnhanced">0</div>

      <div class="stat-label-enhanced">Premium Views</div>

    </div>

    <div class="stat-card-enhanced">

      <div class="stat-number-enhanced" id="availableBalanceEnhanced">$0.00</div>

      <div class="stat-label-enhanced">Available Balance</div>

    </div>

    <div class="stat-card-enhanced">

      <div class="stat-number-enhanced" id="totalEarnedEnhanced">$0.00</div>

      <div class="stat-label-enhanced">Total Earned</div>

    </div>

  </div>



  <!-- Rest of your Overview tab content remains the same -->

  <!-- YouTube Channel Section -->

  <div class="youtube-section">

    <div class="youtube-header">

      <h3 class="section-title">YouTube Channel</h3>

      <div class="youtube-status not-connected" id="youtubeStatus">Not Connected</div>

    </div>

    <div id="youtubeConnected" style="display: none;">

      <div class="youtube-link-display">

        <span class="youtube-icon"><i class="fab fa-youtube"></i></span>

        <span class="youtube-url" id="currentYouTubeUrl">No channel connected</span>

      </div>

      <div class="youtube-actions">

        <button class="btn outline" onclick="openModal('youtubeModal')"><i class="fas fa-edit"></i> Change Channel</button>

        <button class="btn youtube" onclick="visitYouTubeChannel()"><i class="fab fa-youtube"></i> Visit Channel</button>

      </div>

    </div>

    <div id="youtubeNotConnected">

      <button class="btn youtube" onclick="openModal('youtubeModal')">

        <i class="fab fa-youtube"></i> Connect YouTube Channel

      </button>

    </div>

  </div>



  <!-- Quick Withdrawal Section -->

  <div class="withdrawal-section">

    <div class="withdrawal-header">

      <h3 class="section-title">Quick Withdrawal</h3>

      <div class="balance-display" id="withdrawalBalance">$0.00</div>

    </div>

    <div class="withdrawal-actions">

      <button class="btn success" onclick="openModal('withdrawalModal')"><i class="fas fa-money-bill-wave"></i> Request Withdrawal</button>

      <button class="btn outline" onclick="switchCreatorTab('withdrawals')"><i class="fas fa-history"></i> View History</button>

    </div>

  </div>



  <!-- Recent Activity Feed -->

  <div class="settings-section">

    <div class="settings-header">

      <h3 class="settings-title">Recent Activity</h3>

    </div>

    <div id="recentActivity">

      <div class="empty-state">

        <div class="empty-state-icon"><i class="fas fa-clock"></i></div>

        <p>No recent activity</p>

      </div>

    </div>

  </div>

</div>



        <!-- TAB 5: EARNINGS & ANALYTICS (WITH FUNCTIONAL CHART) -->

        <div id="earningsTab" class="tab-content">

          <div class="settings-section">

            <div class="settings-header">

              <h3 class="settings-title">Earnings Overview</h3>

              <div class="chart-controls">

                <div class="chart-period-selector">

                  <button class="period-btn active" onclick="changeChartPeriod('week')">Week</button>

                  <button class="period-btn" onclick="changeChartPeriod('month')">Month</button>

                  <button class="period-btn" onclick="changeChartPeriod('quarter')">Quarter</button>

                  <button class="period-btn" onclick="changeChartPeriod('year')">Year</button>

                </div>

                <button class="chart-export-btn" onclick="exportChartData()">

                  <i class="fas fa-download"></i> Export Data

                </button>

              </div>

            </div>

            <div class="analytics-chart">

              <div class="chart-container">

                <canvas id="earningsChart"></canvas>

              </div>

            </div>

          </div>



          <div class="stats-grid">

            <div class="stat-card">

              <div class="stat-value" id="lifetimeEarnings">$0.00</div>

              <div class="stat-label">Lifetime Earnings</div>

            </div>

            <div class="stat-card">

              <div class="stat-value" id="thisMonthEarnings">$0.00</div>

              <div class="stat-label">This Month</div>

            </div>

            <div class="stat-card">

              <div class="stat-value" id="lastMonthEarnings">$0.00</div>

              <div class="stat-label">Last Month</div>

            </div>

            <div class="stat-card">

              <div class="stat-value" id="avgDailyEarnings">$0.00</div>

              <div class="stat-label">Avg. Daily</div>

            </div>

          </div>

        </div>





        <!-- TAB 6: WITHDRAWALS -->

        <div id="withdrawalsTab" class="tab-content">

          <div class="withdrawal-section">

            <div class="withdrawal-header">

              <h3 class="section-title">Request Withdrawal</h3>

              <div class="balance-display" id="withdrawalsTabBalance">$0.00</div>

            </div>

            <div class="withdrawal-actions">

              <button class="btn success" onclick="openModal('withdrawalModal')"><i class="fas fa-money-bill-wave"></i> Request Withdrawal</button>

              <button class="btn outline" onclick="openModal('paypalModal')"><i class="fab fa-paypal"></i> PayPal Settings</button>

            </div>

          </div>



          <!-- Withdrawal History -->

          <div class="withdrawal-history-section">

            <div class="history-header">

              <h3 class="section-title">Withdrawal History</h3>

              <div class="filter-controls">

                <select class="filter-select" id="statusFilter" onchange="filterWithdrawals()">

                  <option value="all">All Status</option>

                  <option value="pending">Pending</option>

                  <option value="approved">Approved</option>

                  <option value="paid">Paid</option>

                  <option value="rejected">Rejected</option>

                </select>

              </div>

            </div>

            

            <div class="table-container">

              <table class="history-table">

                <thead>

                  <tr>

                    <th>Date</th>

                    <th>Amount</th>

                    <th>PayPal Email</th>

                    <th>Status</th>

                    <th>Processed Date</th>

                    <th>Admin Notes</th>

                  </tr>

                </thead>

                <tbody id="withdrawalHistoryTable">

                  <tr>

                    <td colspan="6" class="table-loading">

                      <div class="loading-spinner"></div>

                      <p>Loading withdrawal history...</p>

                    </td>

                  </tr>

                </tbody>

              </table>

            </div>

          </div>

        </div>



        <!-- TAB 7: MONTHLY REPORTS -->

        <div id="monthlyTab" class="tab-content">

          <div class="settings-section">

            <div class="settings-header">

              <h3 class="settings-title">Monthly Statements</h3>

              <button class="btn outline" onclick="loadMonthlyReports()">

                <i class="fas fa-sync-alt"></i> Refresh

              </button>

            </div>

            

            <!-- Monthly Reports Overview -->

            <div class="stats-grid-enhanced" style="margin-bottom: 30px;">

              <div class="stat-card-enhanced">

                <div class="stat-number-enhanced" id="totalMonthsCount">0</div>

                <div class="stat-label-enhanced">Total Months</div>

              </div>

              <div class="stat-card-enhanced">

                <div class="stat-number-enhanced" id="settledMonthsCount">0</div>

                <div class="stat-label-enhanced">Settled Months</div>

              </div>

              <div class="stat-card-enhanced">

                <div class="stat-number-enhanced" id="totalReportEarnings">$0.00</div>

                <div class="stat-label-enhanced">Total Reported</div>

              </div>

              <div class="stat-card-enhanced">

                <div class="stat-number-enhanced" id="pendingPayouts">$0.00</div>

                <div class="stat-label-enhanced">Pending Payouts</div>

              </div>

            </div>



            <!-- Monthly Reports List -->

            <div id="monthlyReportsList">

              <div class="filter-controls">

                <select class="filter-select" id="reportStatusFilter" onchange="filterMonthlyReports()">

                  <option value="all">All Status</option>

                  <option value="settled">Settled</option>

                  <option value="unsettled">Unsettled</option>

                </select>

                <select class="filter-select" id="reportYearFilter" onchange="filterMonthlyReports()">

                  <option value="all">All Years</option>

                  <!-- Year options will be populated dynamically -->

                </select>

              </div>

              

              <div id="monthlyReportsContainer">

                <div class="empty-state">

                  <div class="empty-state-icon"><i class="fas fa-file-invoice"></i></div>

                  <p>No monthly statements available</p>

                  <p style="font-size: 0.9em; margin-top: 10px;">Your monthly payment statements will appear here</p>

                </div>

              </div>

            </div>

          </div>

        </div>



        <!-- TAB 8: SETTINGS -->

        <div id="settingsTab" class="tab-content">

          <!-- Profile Settings -->

          <div class="settings-section">

            <div class="settings-header">

              <h3 class="settings-title">Profile Settings</h3>

              <button class="btn outline" onclick="openModal('profileModal')">

                <i class="fas fa-edit"></i> Edit Profile

              </button>

            </div>

            <div class="status-details">

              <div class="status-item">

                <span class="status-label">Full Name</span>

                <span class="status-value" id="profileDisplayName">Loading...</span>

              </div>

              <div class="status-item">

                <span class="status-label">Email</span>

                <span class="status-value" id="profileDisplayEmail">Loading...</span>

              </div>

              <div class="status-item">

                <span class="status-label">Member Since</span>

                <span class="status-value" id="memberSince">Loading...</span>

              </div>

              <div class="status-item">

                <span class="status-label">Account Status</span>

                <span class="status-value" id="accountStatus">Loading...</span>

              </div>

            </div>

          </div>



          <!-- YouTube Settings -->

          <div class="settings-section">

            <div class="settings-header">

              <h3 class="settings-title">YouTube Channel</h3>

              <button class="btn outline" onclick="openModal('youtubeModal')">

                <i class="fas fa-edit"></i> Manage

              </button>

            </div>

            <div id="youtubeSettingsInfo">

              <div class="youtube-link-display">

                <span class="youtube-icon"><i class="fab fa-youtube"></i></span>

                <span class="youtube-url" id="settingsYouTubeUrl">No channel connected</span>

              </div>

            </div>

          </div>



          <!-- PayPal Settings -->

          <div class="settings-section">

            <div class="settings-header">

              <h3 class="settings-title">Payment Settings</h3>

              <button class="btn outline" onclick="openModal('paypalModal')">

                <i class="fab fa-paypal"></i> Manage PayPal

              </button>

            </div>

            <div class="status-details">

              <div class="status-item">

                <span class="status-label">PayPal Email</span>

                <span class="status-value" id="settingsPayPalEmail">Not connected</span>

              </div>

              <div class="status-item">

                <span class="status-label">Payment Method</span>

                <span class="status-value">PayPal</span>

              </div>

            </div>

          </div>



          <!-- Security Settings -->

          <div class="settings-section">

            <div class="settings-header">

              <h3 class="settings-title">Security</h3>

              <button class="btn outline" onclick="openModal('passwordModal')">

                <i class="fas fa-key"></i> Change Password

              </button>

            </div>

            <div class="status-details">

              <div class="status-item">

                <span class="status-label">Last Login</span>

                <span class="status-value" id="lastLogin">Loading...</span>

              </div>

              <div class="status-item">

                <span class="status-label">Account Type</span>

                <span class="status-value">Creator</span>

              </div>

            </div>

          </div>

        </div>



      </div>

    </div>

  </div>



  <!-- Profile Settings Modal -->

  <div class="modal" id="profileModal">

    <div class="modal-content">

      <div class="modal-header">

        <h3 class="modal-title">Profile Settings</h3>

        <button class="close-modal" onclick="closeModal('profileModal')"><i class="fas fa-times"></i></button>

      </div>

      <div class="form-group">

        <label class="form-label">Full Name</label>

        <input type="text" class="form-input" id="profileName" placeholder="Your full name">

      </div>

      <div class="form-group">

        <label class="form-label">Email Address</label>

        <input type="email" class="form-input" id="profileEmail" placeholder="Your email" readonly>

      </div>

      <div class="modal-actions">

        <button class="btn outline" onclick="closeModal('profileModal')">Cancel</button>

        <button class="btn main" onclick="updateProfile()">Update Profile</button>

      </div>

    </div>

  </div>



  <!-- Password Reset Modal -->

  <div class="modal" id="passwordModal">

    <div class="modal-content">

      <div class="modal-header">

        <h3 class="modal-title">Change Password</h3>

        <button class="close-modal" onclick="closeModal('passwordModal')"><i class="fas fa-times"></i></button>

      </div>

      <div class="form-group">

        <label class="form-label">Current Password</label>

        <input type="password" class="form-input" id="currentPassword" placeholder="Your current password">

      </div>

      <div class="form-group">

        <label class="form-label">New Password</label>

        <input type="password" class="form-input" id="newPassword" placeholder="New password">

      </div>

      <div class="form-group">

        <label class="form-label">Confirm New Password</label>

        <input type="password" class="form-input" id="confirmPassword" placeholder="Confirm new password">

      </div>

      <div class="modal-actions">

        <button class="btn outline" onclick="closeModal('passwordModal')">Cancel</button>

        <button class="btn main" onclick="updatePassword()">Change Password</button>

      </div>

    </div>

  </div>



  <!-- Footer -->

  <footer>

    <div class="footer-content">

      <div class="footer-left">

        <div class="footer-copyright">2025 EverGreen Empire Ltd</div>

        <a href="mailto:support@evergreenempireltd.com" class="support-email">

          <i class="fas fa-envelope"></i> support@evergreenempireltd.com

        </a>

      </div>

      <div class="footer-right">

        <a href="#" class="social-link"><i class="fab fa-facebook"></i></a>

        <a href="#" class="social-link"><i class="fab fa-twitter"></i></a>

        <a href="#" class="social-link"><i class="fab fa-instagram"></i></a>

        <a href="#" class="social-link"><i class="fab fa-linkedin"></i></a>

      </div>

    </div>

  </footer>



  <!-- Firebase Configuration -->

  <script>

    const firebaseConfig = {

      apiKey: "AIzaSyAuSEqhLenwrEz-qrIn1drjAugy1YSkDlI",

      authDomain: "creators-portal-428c5.firebaseapp.com",

      projectId: "creators-portal-428c5",

      storageBucket: "creators-portal-428c5.firebasestorage.app",

      messagingSenderId: "499280036303",

      appId: "1:499280036303:web:b4d80d3b7fe1291381d2ba",

      measurementId: "G-CYWGD80FS5"

    };



    // Initialize Firebase with error handling

    let app, auth, db;

    try {

      app = firebase.initializeApp(firebaseConfig);

      auth = firebase.auth();

      db = firebase.firestore();

      console.log('Firebase initialized successfully');

    } catch (error) {

      console.log('Firebase already initialized, using existing app');

      app = firebase.app();

      auth = firebase.auth();

      db = firebase.firestore();

    }

  </script>



  <!-- Enhanced Creator Dashboard Script -->

  <script>

    // ========== ENHANCED CREATOR DASHBOARD FUNCTIONALITY ==========



    // Dashboard State Management

    let userData = {};

    let notifications = [];

    let withdrawals = [];

    let monthlyReports = [];

    let creatorVideos = [];

    let isInitialized = false;

    let notificationsListener = null;

    let userListener = null;

    let withdrawalsListener = null;

    let videosListener = null;

    let monthlyReportsListener = null;

    let unreadNotificationsCount = 0;

    let previousUnreadCount = 0;

    let notificationSoundEnabled = true;

    let currentNotificationId = null;

    let filteredNotifications = [];



    // Today's Earnings State

    let todayEarningsData = {

      earnings: 0,

      views: 0,

      videos: 0,

      rpm: 0,

      hourlyEarnings: 0,

      yesterdayEarnings: 0,

      weekToDate: 0,

      monthToDate: 0

    };



    // Earnings Chart Variables

    let earningsChart = null;

    let currentChartPeriod = 'week';

    let earningsData = {

      daily: [],

      weekly: [],

      monthly: [],

      yearly: []

    };



    // Auto Logout Variables

    let logoutTimer;

    let logoutWarningTimer;

    let lastActivityTime;

    const LOGOUT_TIME = 10 * 60 * 1000; // 10 minutes in milliseconds

    const WARNING_TIME = 1 * 60 * 1000; // 1 minute warning before logout



    // Auto Logout Functions

    function resetLogoutTimer() {

      clearTimeout(logoutTimer);

      clearTimeout(logoutWarningTimer);

      

      lastActivityTime = Date.now();

      

      // Set warning timer (9 minutes)

      logoutWarningTimer = setTimeout(showLogoutWarning, LOGOUT_TIME - WARNING_TIME);

      

      // Set actual logout timer (10 minutes)

      logoutTimer = setTimeout(autoLogout, LOGOUT_TIME);

    }



    function showLogoutWarning() {

      const modal = document.getElementById('logoutWarningModal');

      const timerElement = document.getElementById('logoutTimer');

      

      // Show warning modal

      modal.classList.add('active');

      

      // Start countdown from 60 seconds

      let secondsLeft = 60;

      updateTimerDisplay(timerElement, secondsLeft);

      

      const countdown = setInterval(() => {

        secondsLeft--;

        updateTimerDisplay(timerElement, secondsLeft);

        

        if (secondsLeft <= 0) {

          clearInterval(countdown);

          autoLogout();

        }

      }, 1000);

      

      // Store countdown interval to clear if user extends session

      window.logoutCountdown = countdown;

    }



    function updateTimerDisplay(timerElement, seconds) {

      timerElement.textContent = `${seconds}`;

    }



    function extendSession() {

      // Clear the countdown

      if (window.logoutCountdown) {

        clearInterval(window.logoutCountdown);

      }

      

      // Hide warning modal

      document.getElementById('logoutWarningModal').classList.remove('active');

      

      // Reset the logout timer

      resetLogoutTimer();

      

      showNotification('Session extended', 'success');

    }



    function autoLogout() {

      showNotification('Session expired due to inactivity', 'info');

      logout();

    }



    function trackUserActivity() {

      // Add event listeners for user activity

      const activityEvents = ['mousedown', 'mousemove', 'keypress', 'scroll', 'touchstart'];

      

      activityEvents.forEach(event => {

        document.addEventListener(event, resetLogoutTimer, { passive: true });

      });

    }



    // Theme Toggle Function

    function toggleTheme() {

      const currentTheme = document.documentElement.getAttribute('data-theme');

      const newTheme = currentTheme === 'dark' ? 'light' : 'dark';

      

      document.documentElement.setAttribute('data-theme', newTheme);

      localStorage.setItem('theme', newTheme);

      

      // Update theme toggle icon

      const themeIcon = document.querySelector('.theme-toggle i');

      themeIcon.className = newTheme === 'dark' ? 'fas fa-sun' : 'fas fa-moon';

      

      showNotification(`${newTheme === 'dark' ? 'Dark' : 'Light'} theme activated`, 'info');

    }



    // Load saved theme from localStorage

    function loadTheme() {

      const savedTheme = localStorage.getItem('theme') || 'light';

      document.documentElement.setAttribute('data-theme', savedTheme);

      

      // Update theme toggle icon

      const themeIcon = document.querySelector('.theme-toggle i');

      themeIcon.className = savedTheme === 'dark' ? 'fas fa-sun' : 'fas fa-moon';

    }



    // Auto Greeting Function

    function updateGreeting() {

      const greetingElement = document.getElementById('greetingText');

      const hour = new Date().getHours();

      let greeting = '';

      

      if (hour < 12) {

        greeting = 'Good morning';

      } else if (hour < 18) {

        greeting = 'Good afternoon';

      } else {

        greeting = 'Good evening';

      }

      

      // Add user name if available

      const userName = userData.name || 'Creator';

      greetingElement.textContent = `${greeting}, ${userName}!`;

    }



    // Create notification sound

    function createNotificationSound() {

      const audioContext = new (window.AudioContext || window.webkitAudioContext)();

      const oscillator = audioContext.createOscillator();

      const gainNode = audioContext.createGain();

      

      oscillator.connect(gainNode);

      gainNode.connect(audioContext.destination);

      

      oscillator.type = 'sine';

      oscillator.frequency.value = 800;

      gainNode.gain.value = 0.1;

      

      oscillator.start();

      gainNode.gain.exponentialRampToValueAtTime(0.001, audioContext.currentTime + 0.5);

      

      setTimeout(() => {

        oscillator.stop();

      }, 500);

    }



    // Play notification sound

    function playNotificationSound() {

      if (!notificationSoundEnabled) return;

      

      try {

        createNotificationSound();

      } catch (error) {

        console.log('Could not play notification sound:', error);

        // Fallback: Try using HTML5 audio

        try {

          const audio = new Audio('data:audio/wav;base64,UklGRigAAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQQAAAAAAA==');

          audio.volume = 0.1;

          audio.play().catch(e => console.log('Audio play failed:', e));

        } catch (e) {

          console.log('Fallback audio also failed');

        }

      }

    }



    // Enhanced Notification System

    function showNotification(message, type = 'info') {

      const notification = document.getElementById('notification');

      notification.textContent = message;

      notification.className = `notification ${type} show`;

      

      setTimeout(() => {

        notification.classList.remove('show');

      }, 5000);

    }



    // Mobile Menu Functions

    function toggleMenu() {

      const nav = document.getElementById('navMenu');

      nav.classList.toggle('show');

    }



    function closeMenu() {

      const nav = document.getElementById('navMenu');

      nav.classList.remove('show');

    }



    // Enhanced Notifications Panel Toggle

    function toggleNotifications() {

      const panel = document.getElementById('notificationsPanel');

      const isOpening = !panel.classList.contains('active');

      

      panel.classList.toggle('active');

      

      if (isOpening) {

        console.log('Opening notifications panel');

        updateNotificationsDisplay();

      }

      

      closeMenu();

    }



    function closeNotifications() {

      document.getElementById('notificationsPanel').classList.remove('active');

    }



    // Dropdown toggle function

    function toggleDropdown() {

      const dropdown = document.getElementById('settingsDropdown');

      dropdown.classList.toggle('show');

    }



    // Close dropdown when clicking outside

    document.addEventListener('click', function(event) {

      const dropdown = document.getElementById('settingsDropdown');

      const dropdownBtn = document.querySelector('.dropdown-btn');

      

      if (dropdown && dropdownBtn && !dropdown.contains(event.target) && !dropdownBtn.contains(event.target)) {

        dropdown.classList.remove('show');

      }

    });



    // Modal Functions

    function openModal(modalId) {

      document.getElementById(modalId).classList.add('active');

    }



    function closeModal(modalId) {

      document.getElementById(modalId).classList.remove('active');

    }



// ========== TODAY'S EARNINGS FUNCTIONALITY ==========



// Refresh Today's Earnings

function refreshTodayEarnings() {

  const refreshBtn = document.querySelector('.today-earnings-refresh i');

  refreshBtn.style.animation = 'spin 1s linear';

  

  // Simulate API call delay

  setTimeout(() => {

    calculateTodayEarnings();

    refreshBtn.style.animation = '';

    showNotification('Today\'s performance refreshed', 'success');

  }, 1000);

}



// Calculate Today's Earnings from ALL creator content

function calculateTodayEarnings() {

  const today = new Date();

  const todayStr = today.toISOString().split('T')[0];

  

  // Reset today's earnings data

  todayEarningsData = {

    earnings: 0,

    views: 0,

    videos: 0

  };

  

  // Calculate yesterday's date for comparison

  const yesterday = new Date(today);

  yesterday.setDate(yesterday.getDate() - 1);

  const yesterdayStr = yesterday.toISOString().split('T')[0];

  

  // Calculate total earnings and views from ALL videos (not just today's uploads)

  let totalSystemEarnings = 0;

  let totalSystemViews = 0;

  let todayEarnings = 0;

  let todayViews = 0;

  let yesterdayEarnings = 0;

  

  creatorVideos.forEach(video => {

    const videoDate = video.assignedAt?.toDate ? 

                     video.assignedAt.toDate().toISOString().split('T')[0] : 

                     new Date(video.assignedAt).toISOString().split('T')[0];

    

    // Total system earnings (all time)

    totalSystemEarnings += video.creatorPayout || 0;

    totalSystemViews += video.viewCount || 0;

    

    // Today's earnings (revenue generated today from all videos)

    // In a real system, this would come from daily analytics

    // For now, we'll simulate daily earnings based on total

    if (videoDate === todayStr) {

      todayEarnings += video.creatorPayout || 0;

      todayViews += video.viewCount || 0;

    }

    

    // Yesterday's earnings for comparison

    if (videoDate === yesterdayStr) {

      yesterdayEarnings += video.creatorPayout || 0;

    }

  });

  

  // If no specific today data, simulate daily earnings (10% of total)

  if (todayEarnings === 0) {

    todayEarnings = totalSystemEarnings * 0.1;

    todayViews = totalSystemViews * 0.05;

  }

  

  // Update today's earnings data

  todayEarningsData.earnings = todayEarnings;

  todayEarningsData.views = todayViews;

  todayEarningsData.videos = creatorVideos.filter(video => {

    const videoDate = video.assignedAt?.toDate ? 

                     video.assignedAt.toDate().toISOString().split('T')[0] : 

                     new Date(video.assignedAt).toISOString().split('T')[0];

    return videoDate === todayStr;

  }).length;

  

  // Update the UI

  updateTodayEarningsDisplay();

}



// Update Today's Earnings Display

function updateTodayEarningsDisplay() {

  // Update main cards

  document.getElementById('todayEarnings').textContent = `$${todayEarningsData.earnings.toFixed(2)}`;

  document.getElementById('todayViews').textContent = todayEarningsData.views.toLocaleString();

  document.getElementById('todayVideos').textContent = todayEarningsData.videos.toString();

  

  // Update change indicators (simulated - in real app would compare with yesterday)

  const earningsChange = todayEarningsData.earnings * 0.15; // 15% increase

  const viewsChange = Math.floor(todayEarningsData.views * 0.12); // 12% increase

  const videosChange = Math.floor(todayEarningsData.videos * 0.08); // 8% increase

  

  // Update earnings change

  const earningsChangeEl = document.getElementById('todayChange');

  earningsChangeEl.innerHTML = `<i class="fas fa-caret-up"></i><span>+$${earningsChange.toFixed(2)}</span>`;

  earningsChangeEl.className = 'earnings-change positive';

  

  // Update views change

  const viewsChangeEl = document.getElementById('viewsChange');

  viewsChangeEl.innerHTML = `<i class="fas fa-caret-up"></i><span>+${viewsChange.toLocaleString()}</span>`;

  viewsChangeEl.className = 'earnings-change positive';

  

  // Update videos change

  const videosChangeEl = document.getElementById('videosChange');

  videosChangeEl.innerHTML = `<i class="fas fa-caret-up"></i><span>+${videosChange}</span>`;

  videosChangeEl.className = 'earnings-change positive';

}



    // Enhanced clear all notifications

    async function clearAllNotifications() {

      const user = auth.currentUser;

      if (!user) return;

      

      try {

        const notificationsList = document.getElementById('notificationsList');

        notificationsList.innerHTML = '<div class="loading-text"><p>Clearing notifications...</p></div>';

        

        const snapshot = await db.collection('userNotifications')

          .where('userId', '==', user.uid)

          .get();

        

        const deletePromises = [];

        snapshot.forEach(doc => {

          deletePromises.push(db.collection('userNotifications').doc(doc.id).delete());

        });

        

        await Promise.all(deletePromises);

        showNotification('All notifications cleared', 'success');

        

      } catch (error) {

        console.error('Error clearing notifications:', error);

        showNotification('Error clearing notifications', 'error');

      }

    }



    // Delete Single Notification

    async function deleteNotification(notificationId) {

      try {

        await db.collection('userNotifications').doc(notificationId).delete();

        showNotification('Notification deleted', 'success');

        

        // If we're in detail view and delete the current notification, go back to list

        if (notificationId === currentNotificationId) {

          showNotificationListView();

        }

      } catch (error) {

        console.error('Error deleting notification:', error);

        showNotification('Error deleting notification', 'error');

      }

    }



    // UI State Management

    function showAccessDenied() {

      document.getElementById('accessDenied').style.display = 'block';

      document.getElementById('dashboardContent').style.display = 'none';

    }



    function showDashboard() {

      document.getElementById('accessDenied').style.display = 'none';

      document.getElementById('dashboardContent').style.display = 'block';

    }



    function showLoading() {

      document.getElementById('loadingState').style.display = 'block';

      document.getElementById('mainDashboardContent').style.display = 'none';

    }



    function showMainContent() {

      document.getElementById('loadingState').style.display = 'none';

      document.getElementById('mainDashboardContent').style.display = 'block';

    }



    // Enhanced Tab Management

    function switchCreatorTab(tabName) {

      // Hide all tabs

      document.querySelectorAll('.tab-content').forEach(tab => {

        tab.classList.remove('active');

      });

      

      // Remove active class from all tabs

      document.querySelectorAll('.creator-tab').forEach(tab => {

        tab.classList.remove('active');

      });



      // Show selected tab

      document.getElementById(tabName + 'Tab').classList.add('active');

      

      // Add active class to clicked tab (if it's a button, not a link)

      if (event.currentTarget.tagName === 'BUTTON') {

        event.currentTarget.classList.add('active');

      }



      // Load tab-specific data

      switch(tabName) {

        case 'overview':

          loadOverviewData();

          break;

        case 'videos':

          loadVideosData();

          break;

        case 'earnings':

          // Initialize chart if not already done

          if (!earningsChart) {

            initializeEarningsChart();

          }

          loadEarningsData();

          break;

        case 'withdrawals':

          loadWithdrawalsData();

          break;

        case 'monthly':

          loadMonthlyData();

          break;

        case 'notifications':

          loadNotificationsData();

          break;

        case 'settings':

          loadSettingsData();

          break;

      }

    }



    // ========== ENHANCED EARNINGS CHART FUNCTIONALITY ==========



    // Initialize Earnings Chart

    function initializeEarningsChart() {

      const ctx = document.getElementById('earningsChart').getContext('2d');

      

      // Get theme for chart styling

      const isDarkTheme = document.documentElement.getAttribute('data-theme') === 'dark';

      const textColor = isDarkTheme ? '#e2e8f0' : '#001f3f';

      const gridColor = isDarkTheme ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.1)';

      

      earningsChart = new Chart(ctx, {

        type: 'line',

        data: {

          labels: [],

          datasets: [{

            label: 'Daily Earnings ($)',

            data: [],

            borderColor: '#8B5CF6',

            backgroundColor: 'rgba(139, 92, 246, 0.1)',

            borderWidth: 2,

            fill: true,

            tension: 0.4,

            pointBackgroundColor: '#8B5CF6',

            pointBorderColor: '#ffffff',

            pointBorderWidth: 2,

            pointRadius: 4,

            pointHoverRadius: 6

          }]

        },

        options: {

          responsive: true,

          maintainAspectRatio: false,

          plugins: {

            legend: {

              display: true,

              position: 'top',

              labels: {

                color: textColor,

                font: {

                  size: 12

                }

              }

            },

            tooltip: {

              mode: 'index',

              intersect: false,

              backgroundColor: isDarkTheme ? '#2d3748' : '#ffffff',

              titleColor: textColor,

              bodyColor: textColor,

              borderColor: isDarkTheme ? '#4a5568' : '#e2e8f0',

              borderWidth: 1,

              callbacks: {

                label: function(context) {

                  return `Earnings: $${context.parsed.y.toFixed(2)}`;

                }

              }

            }

          },

          scales: {

            x: {

              grid: {

                color: gridColor

              },

              ticks: {

                color: textColor

              }

            },

            y: {

              grid: {

                color: gridColor

              },

              ticks: {

                color: textColor,

                callback: function(value) {

                  return '$' + value.toFixed(2);

                }

              },

              beginAtZero: true

            }

          },

          interaction: {

            mode: 'nearest',

            axis: 'x',

            intersect: false

          }

        }

      });

      

      // Load initial earnings data

      loadEarningsData();

    }



    // Load Earnings Data from Firestore

    async function loadEarningsData() {

      const user = auth.currentUser;

      if (!user) return;

      

      try {

        // In a real implementation, you would fetch this data from Firestore

        // For now, we'll generate sample data based on the user's videos

        

        // Generate daily earnings data for the current period

        generateSampleEarningsData();

        

        // Update the chart with the current period data

        updateEarningsChart();

        

      } catch (error) {

        console.error('Error loading earnings data:', error);

        showNotification('Error loading earnings data', 'error');

      }

    }



    // Generate Sample Earnings Data (Replace with actual Firestore data)

    function generateSampleEarningsData() {

      const now = new Date();

      const userId = auth.currentUser ? auth.currentUser.uid : 'demo';

      

      // Generate daily data for the last 7 days

      earningsData.daily = [];

      for (let i = 6; i >= 0; i--) {

        const date = new Date(now);

        date.setDate(date.getDate() - i);

        

        // Calculate earnings for this day based on user's videos

        const dayEarnings = calculateDailyEarnings(date, userId);

        

        earningsData.daily.push({

          date: date.toISOString().split('T')[0],

          earnings: dayEarnings,

          views: Math.floor(dayEarnings * 100) // Sample view count

        });

      }

      

      // Generate weekly data (last 4 weeks)

      earningsData.weekly = [];

      for (let i = 3; i >= 0; i--) {

        const weekStart = new Date(now);

        weekStart.setDate(weekStart.getDate() - (i * 7));

        const weekEnd = new Date(weekStart);

        weekEnd.setDate(weekEnd.getDate() + 6);

        

        const weekEarnings = calculateWeeklyEarnings(weekStart, userId);

        

        earningsData.weekly.push({

          week: `Week ${4-i}`,

          startDate: weekStart.toISOString().split('T')[0],

          endDate: weekEnd.toISOString().split('T')[0],

          earnings: weekEarnings,

          views: Math.floor(weekEarnings * 700) // Sample view count

        });

      }

      

      // Generate monthly data (last 6 months)

      earningsData.monthly = [];

      for (let i = 5; i >= 0; i--) {

        const month = new Date(now);

        month.setMonth(month.getMonth() - i);

        

        const monthEarnings = calculateMonthlyEarnings(month, userId);

        

        earningsData.monthly.push({

          month: month.toLocaleDateString('en-US', { month: 'short', year: 'numeric' }),

          date: month.toISOString().split('T')[0],

          earnings: monthEarnings,

          views: Math.floor(monthEarnings * 3000) // Sample view count

        });

      }

      

      // Generate yearly data (last 3 years)

      earningsData.yearly = [];

      for (let i = 2; i >= 0; i--) {

        const year = new Date(now);

        year.setFullYear(year.getFullYear() - i);

        

        const yearEarnings = calculateYearlyEarnings(year, userId);

        

        earningsData.yearly.push({

          year: year.getFullYear().toString(),

          date: year.toISOString().split('T')[0],

          earnings: yearEarnings,

          views: Math.floor(yearEarnings * 36000) // Sample view count

        });

      }

    }



    // Calculate Daily Earnings (Replace with actual calculation from Firestore)

    function calculateDailyEarnings(date, userId) {

      // In a real implementation, this would query Firestore for earnings on this date

      // For now, we'll generate sample data based on the user's videos

      

      let dailyEarnings = 0;

      const dateStr = date.toISOString().split('T')[0];

      

      // Sum earnings from videos assigned on this date

      creatorVideos.forEach(video => {

        const videoDate = video.assignedAt?.toDate ? 

                         video.assignedAt.toDate().toISOString().split('T')[0] : 

                         new Date(video.assignedAt).toISOString().split('T')[0];

        

        if (videoDate === dateStr) {

          dailyEarnings += video.creatorPayout || 0;

        }

      });

      

      // If no videos for this date, generate random earnings based on user's average

      if (dailyEarnings === 0) {

        const avgDaily = (userData.totalEarned || 0) / 30; // Average daily earnings

        dailyEarnings = avgDaily * (0.5 + Math.random() * 1.5); // Random variation

        dailyEarnings = Math.max(0.1, dailyEarnings); // Minimum $0.10

      }

      

      return parseFloat(dailyEarnings.toFixed(2));

    }



    // Calculate Weekly Earnings

    function calculateWeeklyEarnings(weekStart, userId) {

      let weeklyEarnings = 0;

      const weekEnd = new Date(weekStart);

      weekEnd.setDate(weekEnd.getDate() + 6);

      

      // Sum daily earnings for the week

      for (let i = 0; i < 7; i++) {

        const day = new Date(weekStart);

        day.setDate(day.getDate() + i);

        weeklyEarnings += calculateDailyEarnings(day, userId);

      }

      

      return parseFloat(weeklyEarnings.toFixed(2));

    }



    // Calculate Monthly Earnings

    function calculateMonthlyEarnings(month, userId) {

      let monthlyEarnings = 0;

      const year = month.getFullYear();

      const monthNum = month.getMonth();

      const daysInMonth = new Date(year, monthNum + 1, 0).getDate();

      

      // Sum daily earnings for the month

      for (let i = 1; i <= daysInMonth; i++) {

        const day = new Date(year, monthNum, i);

        monthlyEarnings += calculateDailyEarnings(day, userId);

      }

      

      return parseFloat(monthlyEarnings.toFixed(2));

    }



    // Calculate Yearly Earnings

    function calculateYearlyEarnings(year, userId) {

      let yearlyEarnings = 0;

      const yearNum = year.getFullYear();

      

      // Sum monthly earnings for the year

      for (let i = 0; i < 12; i++) {

        const month = new Date(yearNum, i, 1);

        yearlyEarnings += calculateMonthlyEarnings(month, userId);

      }

      

      return parseFloat(yearlyEarnings.toFixed(2));

    }



    // Update Earnings Chart with Current Period Data

    function updateEarningsChart() {

      if (!earningsChart) return;

      

      let labels = [];

      let data = [];

      

      switch(currentChartPeriod) {

        case 'week':

          labels = earningsData.daily.map(item => {

            const date = new Date(item.date);

            return date.toLocaleDateString('en-US', { weekday: 'short', month: 'short', day: 'numeric' });

          });

          data = earningsData.daily.map(item => item.earnings);

          earningsChart.data.datasets[0].label = 'Daily Earnings ($)';

          break;

          

        case 'month':

          labels = earningsData.weekly.map(item => item.week);

          data = earningsData.weekly.map(item => item.earnings);

          earningsChart.data.datasets[0].label = 'Weekly Earnings ($)';

          break;

          

        case 'quarter':

          // Show last 3 months as quarters

          labels = [];

          data = [];

          for (let i = 0; i < earningsData.monthly.length; i += 3) {

            const quarterEarnings = earningsData.monthly

              .slice(i, i + 3)

              .reduce((sum, item) => sum + item.earnings, 0);

            labels.push(`Q${Math.floor(i/3) + 1}`);

            data.push(parseFloat(quarterEarnings.toFixed(2)));

          }

          earningsChart.data.datasets[0].label = 'Quarterly Earnings ($)';

          break;

          

        case 'year':

          labels = earningsData.yearly.map(item => item.year);

          data = earningsData.yearly.map(item => item.earnings);

          earningsChart.data.datasets[0].label = 'Yearly Earnings ($)';

          break;

      }

      

      earningsChart.data.labels = labels;

      earningsChart.data.datasets[0].data = data;

      earningsChart.update();

      

      // Update earnings stats

      updateEarningsStats();

    }



    // Change Chart Period

    function changeChartPeriod(period) {

      // Update active button

      document.querySelectorAll('.period-btn').forEach(btn => {

        btn.classList.remove('active');

      });

      event.target.classList.add('active');

      

      currentChartPeriod = period;

      updateEarningsChart();

    }



    // Update Earnings Stats

    function updateEarningsStats() {

      const lifetimeEarnings = userData.totalEarned || 0;

      document.getElementById('lifetimeEarnings').textContent = `$${lifetimeEarnings.toFixed(2)}`;

      

      // Calculate this month and last month earnings

      const currentMonth = new Date().toISOString().slice(0, 7);

      const lastMonth = new Date(new Date().setMonth(new Date().getMonth() - 1)).toISOString().slice(0, 7);

      

      let thisMonthEarnings = 0;

      let lastMonthEarnings = 0;

      

      // Calculate from monthly data if available

      const currentMonthData = earningsData.monthly.find(item => {

        const itemMonth = new Date(item.date).toISOString().slice(0, 7);

        return itemMonth === currentMonth;

      });

      

      const lastMonthData = earningsData.monthly.find(item => {

        const itemMonth = new Date(item.date).toISOString().slice(0, 7);

        return itemMonth === lastMonth;

      });

      

      thisMonthEarnings = currentMonthData ? currentMonthData.earnings : 0;

      lastMonthEarnings = lastMonthData ? lastMonthData.earnings : 0;

      

      document.getElementById('thisMonthEarnings').textContent = `$${thisMonthEarnings.toFixed(2)}`;

      document.getElementById('lastMonthEarnings').textContent = `$${lastMonthEarnings.toFixed(2)}`;

      

      // Calculate average daily earnings

      const totalDays = earningsData.daily.length;

      const totalEarnings = earningsData.daily.reduce((sum, day) => sum + day.earnings, 0);

      const avgDaily = totalDays > 0 ? totalEarnings / totalDays : 0;

      document.getElementById('avgDailyEarnings').textContent = `$${avgDaily.toFixed(2)}`;

    }



    // Export Chart Data

    function exportChartData() {

      let csvContent = "data:text/csv;charset=utf-8,";

      let headers = [];

      let rows = [];

      

      switch(currentChartPeriod) {

        case 'week':

          headers = ["Date", "Earnings ($)", "Views"];

          rows = earningsData.daily.map(item => [item.date, item.earnings, item.views]);

          break;

        case 'month':

          headers = ["Week", "Earnings ($)", "Views", "Start Date", "End Date"];

          rows = earningsData.weekly.map(item => [item.week, item.earnings, item.views, item.startDate, item.endDate]);

          break;

        case 'quarter':

          headers = ["Quarter", "Earnings ($)"];

          // Calculate quarters from monthly data

          const quarterData = [];

          for (let i = 0; i < earningsData.monthly.length; i += 3) {

            const quarterEarnings = earningsData.monthly

              .slice(i, i + 3)

              .reduce((sum, item) => sum + item.earnings, 0);

            quarterData.push([`Q${Math.floor(i/3) + 1}`, parseFloat(quarterEarnings.toFixed(2))]);

          }

          rows = quarterData;

          break;

        case 'year':

          headers = ["Year", "Earnings ($)", "Views"];

          rows = earningsData.yearly.map(item => [item.year, item.earnings, item.views]);

          break;

      }

      

      // Add headers to CSV

      csvContent += headers.join(",") + "\n";

      

      // Add rows to CSV

      rows.forEach(row => {

        csvContent += row.join(",") + "\n";

      });

      

      // Create download link

      const encodedUri = encodeURI(csvContent);

      const link = document.createElement("a");

      link.setAttribute("href", encodedUri);

      link.setAttribute("download", `earnings_data_${currentChartPeriod}.csv`);

      document.body.appendChild(link);

      

      // Trigger download

      link.click();

      document.body.removeChild(link);

      

      showNotification('Earnings data exported successfully', 'success');

    }



    // Update Earnings Display (called when user data changes)

    function updateEarningsDisplay(data) {

      // This function is called when user data is updated

      // Regenerate earnings data based on updated user information

      generateSampleEarningsData();

      updateEarningsChart();

    }



    // ========== ENHANCED NOTIFICATION SYSTEM WITH INTERACTIVE FEATURES ==========



    // Fixed: Enhanced Real-time Notifications Listener

    function setupRealTimeNotifications(userId) {

      if (notificationsListener) {

        console.log(' Removing existing notifications listener');

        notificationsListener();

      }



      console.log(' Setting up enhanced notifications listener for user:', userId);



      // SIMPLIFIED: Direct query without complex ordering that might fail

      notificationsListener = db.collection('userNotifications')

        .where('userId', '==', userId)

        .onSnapshot({

          next: (snapshot) => {

            console.log(' REAL-TIME NOTIFICATION UPDATE');

            console.log(' Total notifications:', snapshot.size);

            

            notifications = [];

            previousUnreadCount = unreadNotificationsCount;

            unreadNotificationsCount = 0;

            

            snapshot.forEach(doc => {

              const data = doc.data();

              console.log(' Notification:', doc.id, data);

              

              notifications.push({ 

                id: doc.id, 

                ...data

              });

              

              if (!data.read) {

                unreadNotificationsCount++;

              }

            });

            

            // Sort by timestamp manually (newest first)

            notifications.sort((a, b) => {

              const timeA = a.timestamp?.toDate ? a.timestamp.toDate().getTime() : new Date(a.timestamp).getTime();

              const timeB = b.timestamp?.toDate ? b.timestamp.toDate().getTime() : new Date(b.timestamp).getTime();

              return timeB - timeA;

            });

            

            console.log(' Final notifications:', notifications.length, 'Unread:', unreadNotificationsCount);

            

            // Check if new notifications arrived and play sound

            if (unreadNotificationsCount > previousUnreadCount) {

              console.log(' New notification detected, playing sound');

              playNotificationSound();

            }

            

            // Update all notification displays

            updateAllNotificationDisplays();

            

            // Show notification for new ones

            if (unreadNotificationsCount > 0) {

              updateNotificationBadges();

            }

          },

          error: (error) => {

            console.error(' NOTIFICATION LISTENER ERROR:', error);

            console.error('Error code:', error.code, 'Message:', error.message);

            

            // Fallback: Try without real-time updates

            loadNotificationsOnce(userId);

          }

        });

    }



    // Fallback: Load notifications once if real-time fails

    async function loadNotificationsOnce(userId) {

      try {

        console.log(' Using fallback notification loading for user:', userId);

        

        const snapshot = await db.collection('userNotifications')

          .where('userId', '==', userId)

          .get();

        

        notifications = [];

        previousUnreadCount = unreadNotificationsCount;

        unreadNotificationsCount = 0;

        

        snapshot.forEach(doc => {

          const data = doc.data();

          notifications.push({ id: doc.id, ...data });

          

          if (!data.read) {

            unreadNotificationsCount++;

          }

        });

        

        // Sort by timestamp

        notifications.sort((a, b) => {

          const timeA = a.timestamp?.toDate ? a.timestamp.toDate().getTime() : new Date(a.timestamp).getTime();

          const timeB = b.timestamp?.toDate ? b.timestamp.toDate().getTime() : new Date(b.timestamp).getTime();

          return timeB - timeA;

        });

        

        console.log(' Fallback notifications loaded:', notifications.length, 'Unread:', unreadNotificationsCount);

        

        // Check if new notifications arrived and play sound

        if (unreadNotificationsCount > previousUnreadCount) {

          console.log(' New notification detected, playing sound');

          playNotificationSound();

        }

        

        updateAllNotificationDisplays();

        updateNotificationBadges();

        

      } catch (error) {

        console.error(' FALLBACK NOTIFICATION LOADING ERROR:', error);

        showNotification('Error loading notifications', 'error');

      }

    }



    // Update all notification displays

    function updateAllNotificationDisplays() {

      updateNotificationsDisplay(); // Panel

      updateNotificationsTabDisplay(); // Notifications tab

      updateNotificationBadges(); // Header badges

    }



    // Update notification badges

    function updateNotificationBadges() {

      const headerBadge = document.getElementById('headerNotificationCount');

      const tabBadge = document.getElementById('tabNotificationCount');

      const panelBadge = document.getElementById('notificationCountBadge');

      

      if (unreadNotificationsCount > 0) {

        headerBadge.textContent = unreadNotificationsCount > 99 ? '99+' : unreadNotificationsCount.toString();

        headerBadge.style.display = 'flex';

        

        tabBadge.textContent = unreadNotificationsCount > 99 ? '99+' : unreadNotificationsCount.toString();

        tabBadge.style.display = 'flex';

        

        panelBadge.textContent = unreadNotificationsCount > 99 ? '99+' : unreadNotificationsCount.toString();

        panelBadge.style.display = 'inline';

        

        // Show notification for new unread messages

        if (unreadNotificationsCount > previousUnreadCount) {

          if (unreadNotificationsCount === 1) {

            showNotification('You have 1 new notification', 'info');

          } else if (unreadNotificationsCount > 1) {

            showNotification(`You have ${unreadNotificationsCount} new notifications`, 'info');

          }

        }

      } else {

        headerBadge.style.display = 'none';

        tabBadge.style.display = 'none';

        panelBadge.style.display = 'none';

      }

    }



    // Update Notifications Display in Panel

    function updateNotificationsDisplay() {

      const notificationsList = document.getElementById('notificationsList');

      

      notificationsList.innerHTML = '';

      

      if (notifications.length === 0) {

        notificationsList.innerHTML = '<p style="text-align: center; color: #64748b; padding: 20px;">No notifications yet</p>';

        return;

      }

      

      notifications.forEach(notification => {

        const notificationElement = document.createElement('div');

        notificationElement.className = `notification-item ${notification.read ? '' : 'unread'}`;

        notificationElement.id = `notification-${notification.id}`;

        

        notificationElement.innerHTML = `

          <div class="notification-actions">

            <button class="notification-action read-toggle" onclick="toggleReadStatus('${notification.id}')" title="${notification.read ? 'Mark as unread' : 'Mark as read'}">

              <i class="fas ${notification.read ? 'fa-envelope' : 'fa-envelope-open'}"></i>

            </button>

            <button class="notification-action delete" onclick="deleteNotification('${notification.id}')" title="Delete">

              <i class="fas fa-trash"></i>

            </button>

          </div>

          <div class="notification-subject" onclick="showNotificationDetail('${notification.id}')">

            ${notification.title || 'Notification'}

            <i class="fas fa-chevron-right"></i>

          </div>

          <div class="notification-message">

            ${notification.message || 'No message content available.'}

          </div>

          <div class="notification-time">${formatTime(notification.timestamp?.toDate())}</div>

        `;

        notificationsList.appendChild(notificationElement);

      });

    }



    // Enhanced Notifications Tab Display

    function updateNotificationsTabDisplay() {

      const notificationsTabList = document.getElementById('notificationsTabList');

      

      if (notifications.length === 0) {

        notificationsTabList.innerHTML = `

          <div class="empty-state">

            <div class="empty-state-icon"><i class="fas fa-bell"></i></div>

            <p>No notifications</p>

            <p style="font-size: 0.9em; margin-top: 10px;">You're all caught up!</p>

          </div>

        `;

        return;

      }

      

      notificationsTabList.innerHTML = '';

      

      notifications.forEach(notification => {

        const notificationElement = document.createElement('div');

        notificationElement.className = `notification-item ${notification.read ? '' : 'unread'}`;

        

        notificationElement.innerHTML = `

          <div class="notification-actions">

            <button class="notification-action read-toggle" onclick="toggleReadStatus('${notification.id}')" title="${notification.read ? 'Mark as unread' : 'Mark as read'}">

              <i class="fas ${notification.read ? 'fa-envelope' : 'fa-envelope-open'}"></i>

            </button>

            <button class="notification-action delete" onclick="deleteNotification('${notification.id}')" title="Delete">

              <i class="fas fa-trash"></i>

            </button>

          </div>

          <div class="notification-subject" onclick="showNotificationDetail('${notification.id}')">

            ${notification.title || 'Notification'}

            <i class="fas fa-chevron-right"></i>

          </div>

          <div class="notification-message">

            ${notification.message || 'No message content available.'}

          </div>

          <div class="notification-time">${formatTime(notification.timestamp?.toDate())}</div>

        `;

        

        notificationsTabList.appendChild(notificationElement);

      });

    }



    // Mark notification as read/unread

    async function toggleReadStatus(notificationId) {

      try {

        const notification = notifications.find(n => n.id === notificationId);

        if (!notification) return;

        

        await db.collection('userNotifications').doc(notificationId).update({ 

          read: !notification.read 

        });

        

        // The real-time listener will update the display automatically

      } catch (error) {

        console.error('Error toggling notification read status:', error);

        showNotification('Error updating notification', 'error');

      }

    }



    // Mark all notifications as read

    async function markAllAsRead() {

      const user = auth.currentUser;

      if (!user) return;

      

      try {

        const snapshot = await db.collection('userNotifications')

          .where('userId', '==', user.uid)

          .where('read', '==', false)

          .get();

        

        const updatePromises = [];

        snapshot.forEach(doc => {

          updatePromises.push(db.collection('userNotifications').doc(doc.id).update({ read: true }));

        });

        

        await Promise.all(updatePromises);

        showNotification('All notifications marked as read', 'success');

        

      } catch (error) {

        console.error('Error marking all notifications as read:', error);

        showNotification('Error updating notifications', 'error');

      }

    }



    // ========== ENHANCED NOTIFICATION DETAIL VIEW ==========



    // Show notification detail view

    function showNotificationDetail(notificationId) {

      const notification = notifications.find(n => n.id === notificationId);

      if (!notification) return;

      

      currentNotificationId = notificationId;

      

      // Update detail view content

      document.getElementById('detailTitle').textContent = notification.title || 'Notification';

      document.getElementById('detailContent').textContent = notification.message || 'No message content available.';

      document.getElementById('detailTime').textContent = formatTime(notification.timestamp?.toDate());

      

      // Update read toggle button

      const readToggleBtn = document.getElementById('readToggleBtn');

      if (notification.read) {

        readToggleBtn.innerHTML = '<i class="fas fa-envelope"></i> Mark as Unread';

      } else {

        readToggleBtn.innerHTML = '<i class="fas fa-envelope-open"></i> Mark as Read';

      }

      

      // Update navigation buttons

      updateNavigationButtons(notificationId);

      

      // Show detail view and hide list view

      document.getElementById('notificationDetailView').style.display = 'block';

      document.getElementById('notificationListView').style.display = 'none';

      

      // Mark as read if unread

      if (!notification.read) {

        toggleReadStatus(notificationId);

      }

    }



    // Show notification list view

    function showNotificationListView() {

      document.getElementById('notificationDetailView').style.display = 'none';

      document.getElementById('notificationListView').style.display = 'block';

      currentNotificationId = null;

    }



    // Update navigation buttons (previous/next)

    function updateNavigationButtons(currentId) {

      const currentIndex = filteredNotifications.findIndex(n => n.id === currentId);

      const prevBtn = document.getElementById('prevBtn');

      const nextBtn = document.getElementById('nextBtn');

      

      prevBtn.disabled = currentIndex <= 0;

      nextBtn.disabled = currentIndex >= filteredNotifications.length - 1;

    }



    // Show previous notification

    function showPreviousNotification() {

      const currentIndex = filteredNotifications.findIndex(n => n.id === currentNotificationId);

      if (currentIndex > 0) {

        showNotificationDetail(filteredNotifications[currentIndex - 1].id);

      }

    }



    // Show next notification

    function showNextNotification() {

      const currentIndex = filteredNotifications.findIndex(n => n.id === currentNotificationId);

      if (currentIndex < filteredNotifications.length - 1) {

        showNotificationDetail(filteredNotifications[currentIndex + 1].id);

      }

    }



    // Filter notifications in the notifications tab

    function filterNotifications() {

      const statusFilter = document.getElementById('notificationFilter').value;

      const typeFilter = document.getElementById('notificationTypeFilter').value;

      

      filteredNotifications = [...notifications];

      

      // Apply status filter

      if (statusFilter === 'unread') {

        filteredNotifications = filteredNotifications.filter(n => !n.read);

      } else if (statusFilter === 'read') {

        filteredNotifications = filteredNotifications.filter(n => n.read);

      }

      

      // Apply type filter

      if (typeFilter !== 'all') {

        filteredNotifications = filteredNotifications.filter(n => n.type === typeFilter);

      }

      

      updateFilteredNotificationsDisplay();

    }



    // Update filtered notifications display

    function updateFilteredNotificationsDisplay() {

      const notificationsTabList = document.getElementById('notificationsTabList');

      

      if (filteredNotifications.length === 0) {

        notificationsTabList.innerHTML = `

          <div class="empty-state">

            <div class="empty-state-icon"><i class="fas fa-filter"></i></div>

            <p>No notifications match your filters</p>

            <button class="btn outline" onclick="resetNotificationFilters()" style="margin-top: 10px;">

              Reset Filters

            </button>

          </div>

        `;

        return;

      }

      

      notificationsTabList.innerHTML = '';

      

      filteredNotifications.forEach(notification => {

        const notificationElement = document.createElement('div');

        notificationElement.className = `notification-item ${notification.read ? '' : 'unread'}`;

        

        notificationElement.innerHTML = `

          <div class="notification-actions">

            <button class="notification-action read-toggle" onclick="toggleReadStatus('${notification.id}')" title="${notification.read ? 'Mark as unread' : 'Mark as read'}">

              <i class="fas ${notification.read ? 'fa-envelope' : 'fa-envelope-open'}"></i>

            </button>

            <button class="notification-action delete" onclick="deleteNotification('${notification.id}')" title="Delete">

              <i class="fas fa-trash"></i>

            </button>

          </div>

          <div class="notification-subject" onclick="showNotificationDetail('${notification.id}')">

            ${notification.title || 'Notification'}

            <i class="fas fa-chevron-right"></i>

          </div>

          <div class="notification-message">

            ${notification.message || 'No message content available.'}

          </div>

          <div class="notification-time">${formatTime(notification.timestamp?.toDate())}</div>

        `;

        

        notificationsTabList.appendChild(notificationElement);

      });

    }



    // Reset notification filters

    function resetNotificationFilters() {

      document.getElementById('notificationFilter').value = 'all';

      document.getElementById('notificationTypeFilter').value = 'all';

      filterNotifications();

    }



    // ========== ENHANCED USER DATA MANAGEMENT ==========



    // Enhanced User Data Loading

    async function setupRealTimeUserData(userId) {

      if (userListener) userListener();

      

      userListener = db.collection('users').doc(userId)

        .onSnapshot({

          next: (doc) => {

            if (doc.exists) {

              userData = doc.data();

              console.log('User data updated:', userData);

              updateAllDisplays(userData);

              updateGreeting();

              

              // Update today's earnings when user data changes

              calculateTodayEarnings();

            }

          },

          error: (error) => {

            console.error('User data listener error:', error);

          }

        });

    }



    // Fixed Real-time Withdrawals Listener

    async function setupRealTimeWithdrawals(userId) {

      if (withdrawalsListener) withdrawalsListener();

      

      console.log('Setting up withdrawals listener for user:', userId);

      

      // Use a simpler query that doesn't require composite index

      withdrawalsListener = db.collection('withdrawals')

        .where('userId', '==', userId)

        .onSnapshot({

          next: (snapshot) => {

            console.log('Withdrawals snapshot received:', snapshot.size, 'documents');

            withdrawals = [];

            

            if (snapshot.empty) {

              console.log('No withdrawal documents found for user:', userId);

              updateWithdrawalHistoryDisplay();

              return;

            }

            

            snapshot.forEach(doc => {

              const data = doc.data();

              console.log('Withdrawal data:', data);

              

              // Convert Firestore timestamps properly

              const withdrawalData = { 

                id: doc.id, 

                ...data,

                createdAt: data.createdAt || new Date(),

                processedAt: data.processedAt || null

              };

              

              withdrawals.push(withdrawalData);

            });

            

            // Sort manually by createdAt date (newest first)

            withdrawals.sort((a, b) => {

              const dateA = a.createdAt?.toDate ? a.createdAt.toDate() : new Date(a.createdAt);

              const dateB = b.createdAt?.toDate ? b.createdAt.toDate() : new Date(b.createdAt);

              return dateB - dateA;

            });

            

            console.log('Withdrawals updated:', withdrawals.length, 'withdrawals');

            updateWithdrawalHistoryDisplay();

          },

          error: (error) => {

            console.error('Withdrawals listener error:', error);

            const tableBody = document.getElementById('withdrawalHistoryTable');

            tableBody.innerHTML = `

              <tr>

                <td colspan="6" class="empty-state">

                  <div class="empty-state-icon"><i class="fas fa-exclamation-triangle"></i></div>

                  <p>Error loading withdrawal history</p>

                  <small style="color: #64748b; margin-top: 10px; display: block;">

                    ${error.message}

                  </small>

                  <button class="btn outline" onclick="retryWithdrawalsLoad()" style="margin-top: 15px;">

                    <i class="fas fa-redo"></i> Retry Loading

                  </button>

                </td>

              </tr>

            `;

          }

        });

    }



    // Setup Real-time Videos Listener

    async function setupRealTimeVideos(userId) {

      if (videosListener) videosListener();

      

      console.log('Setting up videos listener for user:', userId);

      

      videosListener = db.collection('creatorVideos')

        .where('creatorId', '==', userId)

        .onSnapshot({

          next: (snapshot) => {

            console.log('Videos snapshot received:', snapshot.size, 'documents');

            creatorVideos = [];

            

            if (snapshot.empty) {

              console.log('No video documents found for user:', userId);

              updateVideosDisplay();

              return;

            }

            

            snapshot.forEach(doc => {

              const data = doc.data();

              console.log('Video data:', data);

              

              const videoData = { 

                id: doc.id, 

                ...data,

                assignedAt: data.assignedAt || new Date()

              };

              

              creatorVideos.push(videoData);

            });

            

            // Sort by assigned date (newest first)

            creatorVideos.sort((a, b) => {

              const dateA = a.assignedAt?.toDate ? a.assignedAt.toDate() : new Date(a.assignedAt);

              const dateB = b.assignedAt?.toDate ? b.assignedAt.toDate() : new Date(b.assignedAt);

              return dateB - dateA;

            });

            

            console.log('Videos updated:', creatorVideos.length, 'videos');

            updateVideosDisplay();

            

            // Update today's earnings when videos data changes

            calculateTodayEarnings();

          },

          error: (error) => {

            console.error('Videos listener error:', error);

            const videosList = document.getElementById('videosList');

            videosList.innerHTML = `

              <div class="empty-state">

                <div class="empty-state-icon"><i class="fas fa-exclamation-triangle"></i></div>

                <p>Error loading videos</p>

                <small style="color: #64748b; margin-top: 10px; display: block;">

                  ${error.message}

                </small>

                <button class="btn outline" onclick="retryVideosLoad()" style="margin-top: 15px;">

                  <i class="fas fa-redo"></i> Retry Loading

                </button>

              </div>

            `;

          }

        });

    }



    // Setup Real-time Monthly Reports Listener

    async function setupRealTimeMonthlyReports(userId) {

      if (monthlyReportsListener) monthlyReportsListener();

      

      console.log('Setting up monthly reports listener for user:', userId);

      

      monthlyReportsListener = db.collection('monthlyReports')

        .where('creatorId', '==', userId)

        .onSnapshot({

          next: (snapshot) => {

            console.log('Monthly reports snapshot received:', snapshot.size, 'documents');

            monthlyReports = [];

            

            if (snapshot.empty) {

              console.log('No monthly report documents found for user:', userId);

              updateMonthlyReportsDisplay();

              return;

            }

            

            snapshot.forEach(doc => {

              const data = doc.data();

              console.log('Monthly report data:', data);

              

              const reportData = { 

                id: doc.id, 

                ...data,

                month: data.month || new Date(),

                createdAt: data.createdAt || new Date()

              };

              

              monthlyReports.push(reportData);

            });

            

            // Sort by month (newest first)

            monthlyReports.sort((a, b) => {

              const dateA = a.month?.toDate ? a.month.toDate() : new Date(a.month);

              const dateB = b.month?.toDate ? b.month.toDate() : new Date(b.month);

              return dateB - dateA;

            });

            

            console.log('Monthly reports updated:', monthlyReports.length, 'reports');

            updateMonthlyReportsDisplay();

          },

          error: (error) => {

            console.error('Monthly reports listener error:', error);

            const reportsContainer = document.getElementById('monthlyReportsContainer');

            reportsContainer.innerHTML = `

              <div class="empty-state">

                <div class="empty-state-icon"><i class="fas fa-exclamation-triangle"></i></div>

                <p>Error loading monthly reports</p>

                <small style="color: #64748b; margin-top: 10px; display: block;">

                  ${error.message}

                </small>

                <button class="btn outline" onclick="retryMonthlyReportsLoad()" style="margin-top: 15px;">

                  <i class="fas fa-redo"></i> Retry Loading

                </button>

              </div>

            `;

          }

        });

    }



    // Retry functions for loading

    function retryWithdrawalsLoad() {

      const user = auth.currentUser;

      if (user) {

        setupRealTimeWithdrawals(user.uid);

      }

    }



    function retryVideosLoad() {

      const user = auth.currentUser;

      if (user) {

        setupRealTimeVideos(user.uid);

      }

    }



    function retryMonthlyReportsLoad() {

      const user = auth.currentUser;

      if (user) {

        setupRealTimeMonthlyReports(user.uid);

      }

    }



    // Update All Displays with Enhanced Data

    function updateAllDisplays(data) {

      // User Info

      document.getElementById('userEmail').textContent = data.email || auth.currentUser.email;

      document.getElementById('profileEmail').value = data.email || auth.currentUser.email;

      document.getElementById('profileName').value = data.name || '';

      document.getElementById('userInfo').style.display = 'flex';

      

      // Enhanced Stats - Updated to USD

      document.getElementById('totalViewsEnhanced').textContent = (data.totalViews || 0).toLocaleString();

      document.getElementById('premiumViewsEnhanced').textContent = (data.monetizedViews || 0).toLocaleString();

      document.getElementById('availableBalanceEnhanced').textContent = `$${(data.availableBalance || 0).toFixed(2)}`;

      document.getElementById('totalEarnedEnhanced').textContent = `$${(data.totalEarned || 0).toFixed(2)}`;



      // Update all balance displays - Updated to USD

      const balance = data.availableBalance || 0;

      document.getElementById('withdrawalBalance').textContent = `$${balance.toFixed(2)}`;

      document.getElementById('withdrawalsTabBalance').textContent = `$${balance.toFixed(2)}`;

      document.getElementById('modalBalance').textContent = `$${balance.toFixed(2)}`;



      // YouTube Channel

      if (data.youtubeChannel) {

        document.getElementById('currentYouTubeUrl').textContent = data.youtubeChannel;

        document.getElementById('settingsYouTubeUrl').textContent = data.youtubeChannel;

        document.getElementById('youtubeStatus').textContent = 'Connected';

        document.getElementById('youtubeStatus').className = 'youtube-status connected';

        document.getElementById('youtubeConnected').style.display = 'block';

        document.getElementById('youtubeNotConnected').style.display = 'none';

      } else {

        document.getElementById('youtubeConnected').style.display = 'none';

        document.getElementById('youtubeNotConnected').style.display = 'block';

      }



      // PayPal Email

      if (data.paypalEmail) {

        document.getElementById('paypalEmail').value = data.paypalEmail;

        document.getElementById('paypalSettingsEmail').value = data.paypalEmail;

        document.getElementById('paypalConfirmEmail').value = data.paypalEmail;

        document.getElementById('settingsPayPalEmail').textContent = data.paypalEmail;

      }



      // Profile Information

      document.getElementById('profileDisplayName').textContent = data.name || 'Not set';

      document.getElementById('profileDisplayEmail').textContent = data.email || 'Not set';

      document.getElementById('profileName').value = data.name || '';

      document.getElementById('profileEmail').value = data.email || '';

      

      if (data.signUpDate) {

        const signUpDate = data.signUpDate.toDate ? data.signUpDate.toDate() : new Date(data.signUpDate);

        document.getElementById('memberSince').textContent = signUpDate.toLocaleDateString();

      }



      // Account Status

      document.getElementById('accountStatus').textContent = data.status === 'active' ? 'Active' : 'Suspended';

      document.getElementById('accountStatus').style.color = data.status === 'active' ? 'var(--success)' : 'var(--danger)';



      // Update earnings data

      updateEarningsDisplay(data);

      

      // Update today's earnings

      calculateTodayEarnings();

    }



    // Update Videos Display

    function updateVideosDisplay() {

      const videosList = document.getElementById('videosList');

      

      if (creatorVideos.length === 0) {

        videosList.innerHTML = `

          <div class="empty-state">

            <div class="empty-state-icon"><i class="fas fa-play-circle"></i></div>

            <p>No videos found</p>

            <p style="font-size: 0.9em; margin-top: 10px;">Your scanned YouTube Shorts will appear here</p>

          </div>

        `;

        return;

      }

      

      // Calculate video stats for the overview

      let totalVideos = creatorVideos.length;

      let totalViews = 0;

      let totalEarnings = 0;

      

      creatorVideos.forEach(video => {

        totalViews += video.viewCount || 0;

        totalEarnings += video.creatorPayout || 0;

      });

      

      const avgRPM = totalViews > 0 ? (totalEarnings / (totalViews / 1000)) : 0;

      

      // Update video stats overview

      document.getElementById('totalVideosCount').textContent = totalVideos.toLocaleString();

      document.getElementById('totalVideoViews').textContent = totalViews.toLocaleString();

      document.getElementById('totalVideoEarnings').textContent = `$${totalEarnings.toFixed(2)}`;

      document.getElementById('avgRPM').textContent = `$${avgRPM.toFixed(2)}`;

      

      // Generate videos grid

      let videosHTML = '<div class="video-performance-grid">';

      

      creatorVideos.forEach(video => {

        const thumbnail = video.thumbnail || video.thumbnails?.medium || '';

        const assignmentDate = video.assignedAt?.toDate ? video.assignedAt.toDate() : new Date(video.assignedAt);

        const formattedDate = assignmentDate.toLocaleDateString();

        

        videosHTML += `

          <div class="video-performance-card">

            <div class="video-thumbnail">

              ${thumbnail ? 

                `<img src="${thumbnail}" alt="${video.title}" onerror="this.style.display='none'">` : 

                `<div class="video-thumbnail-placeholder">

                  <i class="fas fa-video"></i>

                  <p>No thumbnail</p>

                </div>`

              }

            </div>

            

            <div class="video-details">

              <h4 class="video-title">${video.title || 'Untitled Video'}</h4>

              <div class="video-meta">

                <div class="meta-item">

                  <i class="fas fa-eye"></i> ${formatViewCount(video.viewCount || 0)} views

                </div>

                <div class="meta-item">

                  <i class="fas fa-user"></i> ${video.channelTitle || 'Unknown Channel'}

                </div>

              </div>

            </div>

            

            <div class="video-stats">

              <div class="video-stat">

                <div class="video-stat-value">${formatViewCount(video.viewCount || 0)}</div>

                <div class="video-stat-label">Total Views</div>

              </div>

              <div class="video-stat">

                <div class="video-stat-value">${formatViewCount(video.monetizedViews || 0)}</div>

                <div class="video-stat-label">Premium Views</div>

              </div>

            </div>

            

            <div class="video-earnings">

              <div class="video-earnings-label">Your Earnings</div>

              <div class="video-earnings-value">$${(video.creatorPayout || 0).toFixed(2)}</div>

            </div>

            

            <div class="video-assignment-date">

              Added on ${formattedDate}

            </div>

          </div>

        `;

      });

      

      videosHTML += '</div>';

      videosList.innerHTML = videosHTML;

    }



    // Update Monthly Reports Display

    function updateMonthlyReportsDisplay() {

      const reportsContainer = document.getElementById('monthlyReportsContainer');

      

      if (monthlyReports.length === 0) {

        reportsContainer.innerHTML = `

          <div class="empty-state">

            <div class="empty-state-icon"><i class="fas fa-file-invoice"></i></div>

            <p>No monthly statements available</p>

            <p style="font-size: 0.9em; margin-top: 10px;">Your monthly payment statements will appear here</p>

          </div>

        `;

        return;

      }

      

      // Calculate monthly reports stats

      let totalMonths = monthlyReports.length;

      let settledMonths = 0;

      let totalReported = 0;

      let pendingPayouts = 0;

      const years = new Set();

      

      monthlyReports.forEach(report => {

        if (report.status === 'settled') {

          settledMonths++;

        } else {

          pendingPayouts += report.payoutAmount || 0;

        }

        totalReported += report.totalEarnings || 0;

        

        const reportYear = report.month?.toDate ? report.month.toDate().getFullYear() : 

                         new Date(report.month).getFullYear();

        years.add(reportYear);

      });

      

      // Update monthly reports stats

      document.getElementById('totalMonthsCount').textContent = totalMonths;

      document.getElementById('settledMonthsCount').textContent = settledMonths;

      document.getElementById('totalReportEarnings').textContent = `$${totalReported.toFixed(2)}`;

      document.getElementById('pendingPayouts').textContent = `$${pendingPayouts.toFixed(2)}`;

      

      // Update year filter

      const yearFilter = document.getElementById('reportYearFilter');

      yearFilter.innerHTML = '<option value="all">All Years</option>';

      years.forEach(year => {

        yearFilter.innerHTML += `<option value="${year}">${year}</option>`;

      });

      

      // Generate monthly reports grid

      let reportsHTML = '<div class="monthly-reports-grid">';

      

      monthlyReports.forEach(report => {

        const monthDate = report.month?.toDate ? report.month.toDate() : new Date(report.month);

        const monthName = monthDate.toLocaleDateString('en-US', { year: 'numeric', month: 'long' });

        const createdDate = report.createdAt?.toDate ? report.createdAt.toDate() : new Date(report.createdAt);

        const formattedDate = createdDate.toLocaleDateString();

        const isSettled = report.status === 'settled';

        

        reportsHTML += `

          <div class="monthly-report-card ${isSettled ? 'settled' : 'unsettled'}">

            <div class="report-header">

              <div class="report-month">${monthName}</div>

              <div class="report-status ${isSettled ? 'settled' : 'unsettled'}">

                ${isSettled ? 'Settled' : 'Unsettled'}

              </div>

            </div>

            

            <div class="report-stats">

              <div class="report-stat">

                <div class="report-stat-value">${(report.totalViews || 0).toLocaleString()}</div>

                <div class="report-stat-label">Total Views</div>

              </div>

              <div class="report-stat">

                <div class="report-stat-value">${(report.totalVideos || 0).toLocaleString()}</div>

                <div class="report-stat-label">Total Shorts</div>

              </div>

            </div>

            

            <div class="report-earnings">

              <div class="report-earnings-label">Your Earnings</div>

              <div class="report-earnings-value">$${(report.totalEarnings || 0).toFixed(2)}</div>

            </div>

            

            <div class="report-date">

              Generated on ${formattedDate}

            </div>

          </div>

        `;

      });

      

      reportsHTML += '</div>';

      reportsContainer.innerHTML = reportsHTML;

    }



    // Enhanced Update Withdrawal History Display - Updated to USD

    function updateWithdrawalHistoryDisplay() {

      const tableBody = document.getElementById('withdrawalHistoryTable');

      

      if (!tableBody) {

        console.error('Withdrawal history table body not found');

        return;

      }

      

      console.log('Updating withdrawal display with', withdrawals.length, 'withdrawals');

      

      if (withdrawals.length === 0) {

        tableBody.innerHTML = `

          <tr>

            <td colspan="6" class="empty-state">

              <div class="empty-state-icon"><i class="fas fa-history"></i></div>

              <p>No withdrawal history found</p>

              <p style="font-size: 0.9em; margin-top: 10px;">Your withdrawal requests will appear here once you make your first withdrawal</p>

              <button class="btn success" onclick="openModal('withdrawalModal')" style="margin-top: 15px;">

                <i class="fas fa-money-bill-wave"></i> Make Your First Withdrawal

              </button>

            </td>

          </tr>

        `;

        return;

      }

      

      let tableHTML = '';

      

      withdrawals.forEach(withdrawal => {

        console.log('Processing withdrawal:', withdrawal);

        

        // Format dates safely - handle both Firestore timestamp and regular date

        let requestDate = 'N/A';

        let processedDate = 'Pending';

        

        try {

          if (withdrawal.createdAt) {

            if (withdrawal.createdAt.toDate) {

              requestDate = withdrawal.createdAt.toDate().toLocaleDateString();

            } else if (withdrawal.createdAt.seconds) {

              requestDate = new Date(withdrawal.createdAt.seconds * 1000).toLocaleDateString();

            } else {

              requestDate = new Date(withdrawal.createdAt).toLocaleDateString();

            }

          }

          

          if (withdrawal.processedAt) {

            if (withdrawal.processedAt.toDate) {

              processedDate = withdrawal.processedAt.toDate().toLocaleDateString();

            } else if (withdrawal.processedAt.seconds) {

              processedDate = new Date(withdrawal.processedAt.seconds * 1000).toLocaleDateString();

            } else {

              processedDate = new Date(withdrawal.processedAt).toLocaleDateString();

            }

          }

        } catch (error) {

          console.error('Error formatting dates:', error);

        }

        

        // Determine status badge class

        let statusClass = 'status-pending';

        let statusText = 'Pending';

        

        if (withdrawal.status === 'approved') {

          statusClass = 'status-approved';

          statusText = 'Approved';

        } else if (withdrawal.status === 'paid') {

          statusClass = 'status-paid';

          statusText = 'Paid';

        } else if (withdrawal.status === 'rejected') {

          statusClass = 'status-rejected';

          statusText = 'Rejected';

        }

        

        // Handle admin notes with expandable functionality

        const adminNotes = withdrawal.adminNotes || 'No notes provided';

        const isLongNote = adminNotes.length > 30;

        

        tableHTML += `

          <tr>

            <td>${requestDate}</td>

            <td><strong>$${(withdrawal.amount || 0).toFixed(2)}</strong></td>

            <td>${withdrawal.paypalEmail || 'N/A'}</td>

            <td><span class="status-badge ${statusClass}">${statusText}</span></td>

            <td>${processedDate}</td>

            <td class="admin-notes ${isLongNote ? '' : 'expanded'}" 

                onclick="${isLongNote ? 'this.classList.toggle(\'expanded\')' : ''}">

              ${adminNotes}

            </td>

          </tr>

        `;

      });

      

      tableBody.innerHTML = tableHTML;

      console.log('Withdrawal table updated successfully');

    }



    // Tab-specific data loading functions

    function loadOverviewData() {

      // Overview data is already loaded by real-time listeners

      updateRecentActivity();

    }



    function loadVideosData() {

      // Videos data is already loaded by real-time listeners

      showNotification('Video performance data refreshed', 'success');

    }



    function loadEarningsData() {

      // Earnings data is already loaded by real-time listeners

    }



    function loadWithdrawalsData() {

      // Withdrawals data is already loaded by real-time listeners

    }



    function loadMonthlyData() {

      // Monthly data is already loaded by real-time listeners

      showNotification('Monthly reports data refreshed', 'success');

    }



    function loadNotificationsData() {

      // Initialize filtered notifications with all notifications

      filteredNotifications = [...notifications];

      updateFilteredNotificationsDisplay();

    }



    function loadSettingsData() {

      // Settings data is already loaded by real-time listeners

      document.getElementById('lastLogin').textContent = new Date().toLocaleDateString();

    }



    // Update Recent Activity

    function updateRecentActivity() {

      const recentActivity = document.getElementById('recentActivity');

      const activities = [];

      

      // Add withdrawal activities

      withdrawals.slice(0, 5).forEach(withdrawal => {

        activities.push({

          type: 'withdrawal',

          message: `Withdrawal request for $${withdrawal.amount?.toFixed(2)} - ${withdrawal.status}`,

          time: withdrawal.createdAt

        });

      });

      

      // Add video activities

      creatorVideos.slice(0, 3).forEach(video => {

        activities.push({

          type: 'video',

          message: `New Shorts scanned: "${video.title}" - $${(video.creatorPayout || 0).toFixed(2)} earned`,

          time: video.assignedAt

        });

      });

      

      // Add notification activities

      notifications.slice(0, 3).forEach(notification => {

        activities.push({

          type: 'notification',

          message: notification.title,

          time: notification.timestamp

        });

      });

      

      if (activities.length === 0) {

        recentActivity.innerHTML = `

          <div class="empty-state">

            <div class="empty-state-icon"><i class="fas fa-clock"></i></div>

            <p>No recent activity</p>

          </div>

        `;

        return;

      }

      

      // Sort by time (newest first)

      activities.sort((a, b) => (b.time?.toDate() || 0) - (a.time?.toDate() || 0));

      

      let activityHTML = '';

      activities.forEach(activity => {

        activityHTML += `

          <div class="notification-item" style="margin-bottom: 10px;">

            <div class="notification-message expanded">

              ${activity.message}

            </div>

            <div class="notification-time">${formatTime(activity.time?.toDate())}</div>

          </div>

        `;

      });

      

      recentActivity.innerHTML = activityHTML;

    }



    // Filter Videos

    function filterVideos() {

      const sortFilter = document.getElementById('videoSortFilter').value;

      const searchTerm = document.getElementById('videoSearch').value.toLowerCase();

      

      let filteredVideos = [...creatorVideos];

      

      // Apply search filter

      if (searchTerm) {

        filteredVideos = filteredVideos.filter(video => 

          (video.title && video.title.toLowerCase().includes(searchTerm)) ||

          (video.channelTitle && video.channelTitle.toLowerCase().includes(searchTerm))

        );

      }

      

      // Apply sort filter

      switch(sortFilter) {

        case 'newest':

          filteredVideos.sort((a, b) => {

            const dateA = a.assignedAt?.toDate ? a.assignedAt.toDate() : new Date(a.assignedAt);

            const dateB = b.assignedAt?.toDate ? b.assignedAt.toDate() : new Date(b.assignedAt);

            return dateB - dateA;

          });

          break;

        case 'oldest':

          filteredVideos.sort((a, b) => {

            const dateA = a.assignedAt?.toDate ? a.assignedAt.toDate() : new Date(a.assignedAt);

            const dateB = b.assignedAt?.toDate ? b.assignedAt.toDate() : new Date(b.assignedAt);

            return dateA - dateB;

          });

          break;

        case 'highestEarnings':

          filteredVideos.sort((a, b) => (b.creatorPayout || 0) - (a.creatorPayout || 0));

          break;

        case 'mostViews':

          filteredVideos.sort((a, b) => (b.viewCount || 0) - (a.viewCount || 0));

          break;

      }

      

      updateFilteredVideosDisplay(filteredVideos);

    }



    // Update filtered videos display

    function updateFilteredVideosDisplay(filteredVideos) {

      const videosList = document.getElementById('videosList');

      

      if (filteredVideos.length === 0) {

        videosList.innerHTML = `

          <div class="empty-state">

            <div class="empty-state-icon"><i class="fas fa-filter"></i></div>

            <p>No videos match your search criteria</p>

            <button class="btn outline" onclick="resetVideoFilters()" style="margin-top: 10px;">

              Reset Filters

            </button>

          </div>

        `;

        return;

      }

      

      let videosHTML = '<div class="video-performance-grid">';

      

      filteredVideos.forEach(video => {

        const thumbnail = video.thumbnail || video.thumbnails?.medium || '';

        const assignmentDate = video.assignedAt?.toDate ? video.assignedAt.toDate() : new Date(video.assignedAt);

        const formattedDate = assignmentDate.toLocaleDateString();

        

        videosHTML += `

          <div class="video-performance-card">

            <div class="video-thumbnail">

              ${thumbnail ? 

                `<img src="${thumbnail}" alt="${video.title}" onerror="this.style.display='none'">` : 

                `<div class="video-thumbnail-placeholder">

                  <i class="fas fa-video"></i>

                  <p>No thumbnail</p>

                </div>`

              }

            </div>

            

            <div class="video-details">

              <h4 class="video-title">${video.title || 'Untitled Video'}</h4>

              <div class="video-meta">

                <div class="meta-item">

                  <i class="fas fa-eye"></i> ${formatViewCount(video.viewCount || 0)} views

                </div>

                <div class="meta-item">

                  <i class="fas fa-user"></i> ${video.channelTitle || 'Unknown Channel'}

                </div>

              </div>

            </div>

            

            <div class="video-stats">

              <div class="video-stat">

                <div class="video-stat-value">${formatViewCount(video.viewCount || 0)}</div>

                <div class="video-stat-label">Total Views</div>

              </div>

              <div class="video-stat">

                <div class="video-stat-value">${formatViewCount(video.monetizedViews || 0)}</div>

                <div class="video-stat-label">Premium Views</div>

              </div>

            </div>

            

            <div class="video-earnings">

              <div class="video-earnings-label">Your Earnings</div>

              <div class="video-earnings-value">$${(video.creatorPayout || 0).toFixed(2)}</div>

            </div>

            

            <div class="video-assignment-date">

              Added on ${formattedDate}

            </div>

          </div>

        `;

      });

      

      videosHTML += '</div>';

      videosList.innerHTML = videosHTML;

    }



    // Reset video filters

    function resetVideoFilters() {

      document.getElementById('videoSortFilter').value = 'newest';

      document.getElementById('videoSearch').value = '';

      filterVideos();

    }



    // Filter Monthly Reports

    function filterMonthlyReports() {

      const statusFilter = document.getElementById('reportStatusFilter').value;

      const yearFilter = document.getElementById('reportYearFilter').value;

      

      let filteredReports = [...monthlyReports];

      

      // Apply status filter

      if (statusFilter !== 'all') {

        filteredReports = filteredReports.filter(report => 

          report.status === (statusFilter === 'settled' ? 'settled' : 'unsettled')

        );

      }

      

      // Apply year filter

      if (yearFilter !== 'all') {

        filteredReports = filteredReports.filter(report => {

          const reportYear = report.month?.toDate ? report.month.toDate().getFullYear() : 

                           new Date(report.month).getFullYear();

          return reportYear.toString() === yearFilter;

        });

      }

      

      updateFilteredMonthlyReportsDisplay(filteredReports);

    }



    // Update filtered monthly reports display

    function updateFilteredMonthlyReportsDisplay(filteredReports) {

      const reportsContainer = document.getElementById('monthlyReportsContainer');

      

      if (filteredReports.length === 0) {

        reportsContainer.innerHTML = `

          <div class="empty-state">

            <div class="empty-state-icon"><i class="fas fa-filter"></i></div>

            <p>No monthly reports match your filters</p>

            <button class="btn outline" onclick="resetMonthlyReportFilters()" style="margin-top: 10px;">

              Reset Filters

            </button>

          </div>

        `;

        return;

      }

      

      let reportsHTML = '<div class="monthly-reports-grid">';

      

      filteredReports.forEach(report => {

        const monthDate = report.month?.toDate ? report.month.toDate() : new Date(report.month);

        const monthName = monthDate.toLocaleDateString('en-US', { year: 'numeric', month: 'long' });

        const createdDate = report.createdAt?.toDate ? report.createdAt.toDate() : new Date(report.createdAt);

        const formattedDate = createdDate.toLocaleDateString();

        const isSettled = report.status === 'settled';

        

        reportsHTML += `

          <div class="monthly-report-card ${isSettled ? 'settled' : 'unsettled'}">

            <div class="report-header">

              <div class="report-month">${monthName}</div>

              <div class="report-status ${isSettled ? 'settled' : 'unsettled'}">

                ${isSettled ? 'Settled' : 'Unsettled'}

              </div>

            </div>

            

            <div class="report-stats">

              <div class="report-stat">

                <div class="report-stat-value">${(report.totalViews || 0).toLocaleString()}</div>

                <div class="report-stat-label">Total Views</div>

              </div>

              <div class="report-stat">

                <div class="report-stat-value">${(report.totalVideos || 0).toLocaleString()}</div>

                <div class="report-stat-label">Total Shorts</div>

              </div>

            </div>

            

            <div class="report-earnings">

              <div class="report-earnings-label">Your Earnings</div>

              <div class="report-earnings-value">$${(report.totalEarnings || 0).toFixed(2)}</div>

            </div>

            

            <div class="report-date">

              Generated on ${formattedDate}

            </div>

          </div>

        `;

      });

      

      reportsHTML += '</div>';

      reportsContainer.innerHTML = reportsHTML;

    }



    // Reset monthly report filters

    function resetMonthlyReportFilters() {

      document.getElementById('reportStatusFilter').value = 'all';

      document.getElementById('reportYearFilter').value = 'all';

      filterMonthlyReports();

    }



    // Filter Withdrawals

    function filterWithdrawals() {

      const statusFilter = document.getElementById('statusFilter').value;

      

      let filteredWithdrawals = [...withdrawals];

      

      // Apply status filter

      if (statusFilter !== 'all') {

        filteredWithdrawals = filteredWithdrawals.filter(w => w.status === statusFilter);

      }

      

    // Update display with filtered withdrawals

  const tableBody = document.getElementById('withdrawalHistoryTable');

  

  if (filteredWithdrawals.length === 0) {

    tableBody.innerHTML = `

      <tr>

        <td colspan="6" class="empty-state">

          <div class="empty-state-icon"><i class="fas fa-filter"></i></div>

          <p>No withdrawals match your filters</p>

          <button class="btn outline" onclick="resetFilters()" style="margin-top: 10px;">

            Reset Filters

          </button>

        </td>

      </tr>

    `;

    return;

  }

  

  tableBody.innerHTML = '';

  

  filteredWithdrawals.forEach(withdrawal => {

    const row = document.createElement('tr');

    

    const requestDate = withdrawal.createdAt ? 

      withdrawal.createdAt.toDate().toLocaleDateString() : 'N/A';

    

    const processedDate = withdrawal.processedAt ? 

      withdrawal.processedAt.toDate().toLocaleDateString() : 'Pending';

    

    let statusClass = 'status-pending';

    let statusText = 'Pending';

    

    if (withdrawal.status === 'approved') {

      statusClass = 'status-approved';

      statusText = 'Approved';

    } else if (withdrawal.status === 'completed') {  //  ADDED THIS LINE

      statusClass = 'status-paid';

      statusText = 'Completed';

    } else if (withdrawal.status === 'paid') {

      statusClass = 'status-paid';

      statusText = 'Paid';

    } else if (withdrawal.status === 'rejected') {

      statusClass = 'status-rejected';

      statusText = 'Rejected';

    }

    

    const adminNotes = withdrawal.adminNotes || 'No notes';

    const isLongNote = adminNotes.length > 30;

    

    row.innerHTML = `

      <td>${requestDate}</td>

      <td><strong>$${withdrawal.amount?.toFixed(2) || '0.00'}</strong></td>

      <td>${withdrawal.paypalEmail || 'N/A'}</td>

      <td><span class="status-badge ${statusClass}">${statusText}</span></td>

      <td>${processedDate}</td>

      <td class="admin-notes ${isLongNote ? '' : 'expanded'}" 

          onclick="${isLongNote ? 'this.classList.toggle(\'expanded\')' : ''}">

        ${adminNotes}

      </td>

    `;

    

    tableBody.appendChild(row);

  });

}    



    // Reset filters

    function resetFilters() {

      document.getElementById('statusFilter').value = 'all';

      updateWithdrawalHistoryDisplay();

    }



    // ========== FEATURE FUNCTIONS ==========



    // YouTube Channel Functions

    async function saveYouTubeChannel() {

      const youtubeUrl = document.getElementById('youtubeChannelUrl').value;

      const channelName = document.getElementById('channelName').value;

      

      if (!youtubeUrl) {

        showNotification('Please enter your YouTube channel URL', 'error');

        return;

      }

      

      if (!isValidYouTubeUrl(youtubeUrl)) {

        showNotification('Please enter a valid YouTube channel URL', 'error');

        return;

      }

      

      const user = auth.currentUser;

      

      try {

        await db.collection('users').doc(user.uid).set({

          youtubeChannel: youtubeUrl,

          youtubeChannelName: channelName || 'YouTube Channel',

          youtubeConnectedAt: new Date(),

          lastUpdated: firebase.firestore.FieldValue.serverTimestamp()

        }, { merge: true });

        

        showNotification('YouTube channel connected successfully!', 'success');

        closeModal('youtubeModal');

        

      } catch (error) {

        console.error('Error saving YouTube channel:', error);

        showNotification('Error saving YouTube channel', 'error');

      }

    }



    function visitYouTubeChannel() {

      if (userData.youtubeChannel) {

        window.open(userData.youtubeChannel, '_blank');

      } else {

        showNotification('No YouTube channel connected', 'error');

      }

    }



    function isValidYouTubeUrl(url) {

      const youtubeRegex = /^(https?:\/\/)?(www\.)?(youtube\.com|youtu\.?be)\/.+$/;

      return youtubeRegex.test(url);

    }



    // Withdrawal Functions - Updated to USD

    async function requestWithdrawal() {

      const amount = parseFloat(document.getElementById('withdrawalAmount').value);

      const paypalEmail = document.getElementById('paypalEmail').value;

      

      if (!amount || amount < 10) {

        showNotification('Minimum withdrawal amount is $10', 'error');

        return;

      }

      

      if (!paypalEmail || !isValidEmail(paypalEmail)) {

        showNotification('Please enter a valid PayPal email', 'error');

        return;

      }

      

      const user = auth.currentUser;

      

      try {

        const availableBalance = parseFloat(userData.availableBalance || 0);

        

        if (amount > availableBalance) {

          showNotification('Insufficient balance for this withdrawal', 'error');

          return;

        }

        

        // Create withdrawal request

        const withdrawalData = {

          userId: user.uid,

          userEmail: user.email,

          amount: amount,

          paypalEmail: paypalEmail,

          status: 'pending',

          createdAt: firebase.firestore.FieldValue.serverTimestamp(),

          userName: userData.name || user.email,

          youtubeChannel: userData.youtubeChannel || null,

          youtubeChannelName: userData.youtubeChannelName || null

        };

        

        console.log('Creating withdrawal:', withdrawalData);

        

        await db.collection('withdrawals').add(withdrawalData);

        

        showNotification('Withdrawal request submitted successfully!', 'success');

        closeModal('withdrawalModal');

        document.getElementById('withdrawalAmount').value = '';

        

      } catch (error) {

        console.error('Error requesting withdrawal:', error);

        showNotification('Error submitting withdrawal request', 'error');

      }

    }



    // PayPal Settings

    async function savePayPalSettings() {

      const email = document.getElementById('paypalSettingsEmail').value;

      const confirmEmail = document.getElementById('paypalConfirmEmail').value;

      

      if (!email || !isValidEmail(email)) {

        showNotification('Please enter a valid email address', 'error');

        return;

      }

      

      if (email !== confirmEmail) {

        showNotification('Email addresses do not match', 'error');

        return;

      }

      

      const user = auth.currentUser;

      

      try {

        await db.collection('users').doc(user.uid).set({

          paypalEmail: email,

          lastUpdated: firebase.firestore.FieldValue.serverTimestamp()

        }, { merge: true });

        

        showNotification('PayPal settings updated successfully', 'success');

        closeModal('paypalModal');

        

      } catch (error) {

        console.error('Error saving PayPal settings:', error);

        showNotification('Error saving PayPal settings', 'error');

      }

    }



    // Profile Settings

    async function updateProfile() {

      const name = document.getElementById('profileName').value;

      

      if (!name) {

        showNotification('Please enter your name', 'error');

        return;

      }

      

      const user = auth.currentUser;

      

      try {

        await db.collection('users').doc(user.uid).set({

          name: name,

          lastUpdated: firebase.firestore.FieldValue.serverTimestamp()

        }, { merge: true });

        

        showNotification('Profile updated successfully', 'success');

        closeModal('profileModal');

        

      } catch (error) {

        console.error('Error updating profile:', error);

        showNotification('Error updating profile', 'error');

      }

    }



    // Password Update

    async function updatePassword() {

      const currentPassword = document.getElementById('currentPassword').value;

      const newPassword = document.getElementById('newPassword').value;

      const confirmPassword = document.getElementById('confirmPassword').value;

      

      if (!currentPassword || !newPassword || !confirmPassword) {

        showNotification('Please fill in all password fields', 'error');

        return;

      }

      

      if (newPassword !== confirmPassword) {

        showNotification('New passwords do not match', 'error');

        return;

      }

      

      if (newPassword.length < 6) {

        showNotification('Password must be at least 6 characters', 'error');

        return;

      }

      

      const user = auth.currentUser;

      const credential = firebase.auth.EmailAuthProvider.credential(user.email, currentPassword);

      

      try {

        await user.reauthenticateWithCredential(credential);

        await user.updatePassword(newPassword);

        

        showNotification('Password updated successfully', 'success');

        closeModal('passwordModal');

        

        document.getElementById('currentPassword').value = '';

        document.getElementById('newPassword').value = '';

        document.getElementById('confirmPassword').value = '';

        

      } catch (error) {

        if (error.code === 'auth/wrong-password') {

          showNotification('Current password is incorrect', 'error');

        } else {

          console.error('Error updating password:', error);

          showNotification('Error updating password', 'error');

        }

      }

    }



    // Utility Functions

    function isValidEmail(email) {

      const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;

      return emailRegex.test(email);

    }



    function formatTime(date) {

      if (!date) return 'Recently';

      const now = new Date();

      const diffMs = now - date;

      const diffMins = Math.floor(diffMs / 60000);

      const diffHours = Math.floor(diffMs / 3600000);

      const diffDays = Math.floor(diffMs / 86400000);

      

      if (diffMins < 1) return 'Just now';

      if (diffMins < 60) return `${diffMins} min ago`;

      if (diffHours < 24) return `${diffHours} hr ago`;

      if (diffDays < 7) return `${diffDays} day${diffDays > 1 ? 's' : ''} ago`;

      return date.toLocaleDateString();

    }



    function formatViewCount(count) {

      if (!count) return '0';

      if (count >= 1000000) {

        return (count / 1000000).toFixed(1) + 'M';

      } else if (count >= 1000) {

        return (count / 1000).toFixed(1) + 'K';

      }

      return count.toString();

    }



    function formatMonthName(monthString) {

      const [year, month] = monthString.split('-');

      const date = new Date(year, month - 1);

      return date.toLocaleDateString('en-US', { year: 'numeric', month: 'long' });

    }



    async function refreshStats() {

      const user = auth.currentUser;

      if (user) {

        showNotification('Refreshing statistics...', 'info');

        // Refresh today's earnings

        refreshTodayEarnings();

      }

    }



    // Enhanced Logout Function

    async function logout() {

      try {

        // Clear all timers

        clearTimeout(logoutTimer);

        clearTimeout(logoutWarningTimer);

        if (window.logoutCountdown) {

          clearInterval(window.logoutCountdown);

        }

        

        // Remove all real-time listeners

        if (notificationsListener) notificationsListener();

        if (userListener) userListener();

        if (withdrawalsListener) withdrawalsListener();

        if (videosListener) videosListener();

        if (monthlyReportsListener) monthlyReportsListener();

        

        notificationsListener = null;

        userListener = null;

        withdrawalsListener = null;

        videosListener = null;

        monthlyReportsListener = null;

        

        await auth.signOut();

        showNotification('Successfully signed out', 'success');

        

        // Redirect to sign-in page

        setTimeout(() => {

          window.location.href = '/sign-in/';

        }, 1000);

        

      } catch (error) {

        console.error('Logout error:', error);

        showNotification('Error signing out', 'error');

        // Still redirect to sign-in page

        setTimeout(() => {

          window.location.href = '/sign-in/';

        }, 2000);

      }

    }



    function redirectToLogin() {

      window.location.href = '/sign-in/';

    }



    // Enhanced initialization

    async function loadUserData(userId) {

      try {

        console.log('Loading user data for:', userId);

        showLoading();

        

        // Setup all real-time listeners

        await setupRealTimeUserData(userId);

        await setupRealTimeNotifications(userId);

        await setupRealTimeWithdrawals(userId);

        await setupRealTimeVideos(userId);

        await setupRealTimeMonthlyReports(userId);

        

        showMainContent();

        showNotification('Dashboard loaded successfully!', 'success');

        

        // Debug: Check if data is loading

        setTimeout(() => {

          console.log('Data loaded - Videos:', creatorVideos.length, 'Withdrawals:', withdrawals.length, 'Monthly Reports:', monthlyReports.length);

        }, 2000);

        

      } catch (error) {

        console.error('Error loading user data:', error);

        showNotification('Error loading dashboard data', 'error');

      }

    }



    // Initialize Enhanced Dashboard

    async function initializeDashboard() {

      if (isInitialized) return;

      

      showLoading();

      showDashboard();

      

      try {

        auth.onAuthStateChanged(async (user) => {

          if (user) {

            console.log('User authenticated:', user.email);

            

            const userDoc = await db.collection('users').doc(user.uid).get();

            if (userDoc.exists) {

              const userData = userDoc.data();

              if (userData.role === 'admin') {

                showNotification('Redirecting to admin portal...', 'info');

                setTimeout(() => {

                  window.location.href = '/admin/';

                }, 2000);

                return;

              }

            }

            

            // Load saved theme

            loadTheme();

            

            // Start auto logout timer

            resetLogoutTimer();

            trackUserActivity();

            

            await loadUserData(user.uid);

          } else {

            console.log('No user authenticated');

            showAccessDenied();

          }

        });

        

        isInitialized = true;

      } catch (error) {

        console.error('Initializing dashboard:', error);

      }

    }



    // Event Listeners for closing modals when clicking outside

    document.addEventListener('click', function(event) {

      // Close modals when clicking outside

      const modals = document.querySelectorAll('.modal.active');

      modals.forEach(modal => {

        if (event.target === modal) {

          modal.classList.remove('active');

        }

      });

      

      // Close notifications panel when clicking outside

      const notificationsPanel = document.getElementById('notificationsPanel');

      if (event.target === notificationsPanel) {

        closeNotifications();

      }

      

      // Close mobile menu when clicking outside

      const nav = document.getElementById('navMenu');

      const menuIcon = document.querySelector('.menu-icon');

      if (nav && menuIcon && !nav.contains(event.target) && !menuIcon.contains(event.target) && nav.classList.contains('show')) {

        closeMenu();

      }

    });



    // Initialize the enhanced dashboard when page loads

    document.addEventListener('DOMContentLoaded', function() {

      console.log('Enhanced Creator Dashboard with Today\'s Earnings initializing...');

      initializeDashboard();

    });



  </script>

  
<!-- ================================ -->
<!-- SIMPLE CHAT WIDGET - REDIRECTS TO CHAT PAGE -->
<!-- ================================ -->

<!-- Chat Widget Styles -->
<style>
  .chat-widget-container {
    position: fixed;
    bottom: 30px;
    right: 30px;
    z-index: 1000;
  }

  .chat-widget-button {
    width: 70px;
    height: 70px;
    background: linear-gradient(135deg, #0066ff 0%, #00a8ff 100%);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 1.8em;
    cursor: pointer;
    box-shadow: 0 15px 35px rgba(0, 102, 255, 0.4);
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    border: none;
    position: relative;
    overflow: hidden;
    text-decoration: none;
  }

  .chat-widget-button::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(135deg, rgba(255,255,255,0.2) 0%, transparent 100%);
    border-radius: 50%;
  }

  .chat-widget-button:hover {
    transform: scale(1.15) rotate(5deg);
    box-shadow: 0 20px 45px rgba(0, 102, 255, 0.6);
  }

  .chat-widget-button.has-notification {
    animation: wiggle 2s ease-in-out infinite;
  }

  .notification-badge {
    position: absolute;
    top: 8px;
    right: 8px;
    width: 20px;
    height: 20px;
    background: #dc3545;
    border-radius: 50%;
    border: 3px solid white;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.7em;
    font-weight: 700;
    color: white;
    animation: pulse 2s infinite;
    box-shadow: 0 4px 10px rgba(220, 53, 69, 0.4);
  }

  @keyframes wiggle {
    0%, 7% { transform: rotate(0); }
    2% { transform: rotate(-8deg); }
    4% { transform: rotate(8deg); }
    6% { transform: rotate(-4deg); }
    8% { transform: rotate(0); }
  }

  @keyframes pulse {
    0% { transform: scale(1); box-shadow: 0 4px 10px rgba(220, 53, 69, 0.4); }
    50% { transform: scale(1.1); box-shadow: 0 6px 15px rgba(220, 53, 69, 0.6); }
    100% { transform: scale(1); box-shadow: 0 4px 10px rgba(220, 53, 69, 0.4); }
  }

  .message-toast {
    position: fixed;
    bottom: 120px;
    right: 30px;
    background: white;
    border-radius: 12px;
    padding: 16px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
    border-left: 4px solid #0066ff;
    display: flex;
    align-items: center;
    gap: 12px;
    max-width: 300px;
    transform: translateX(150%);
    transition: transform 0.3s ease;
    z-index: 1001;
  }

  .message-toast.show {
    transform: translateX(0);
  }

  .toast-icon {
    width: 36px;
    height: 36px;
    background: linear-gradient(135deg, #0066ff 0%, #00a8ff 100%);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 0.9em;
  }

  .toast-content {
    flex: 1;
  }

  .toast-title {
    font-weight: 600;
    font-size: 0.9em;
    color: #001f3f;
    margin-bottom: 4px;
  }

  .toast-message {
    font-size: 0.8em;
    color: #64748b;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  @media (max-width: 768px) {
    .chat-widget-container {
      bottom: 20px;
      right: 20px;
    }

    .chat-widget-button {
      width: 60px;
      height: 60px;
      font-size: 1.5em;
    }

    .notification-badge {
      width: 18px;
      height: 18px;
      font-size: 0.65em;
    }

    .message-toast {
      right: 20px;
      left: 20px;
      max-width: none;
    }
  }
</style>

<!-- Chat Widget HTML -->
<div class="chat-widget-container" id="chatWidgetContainer">
  <a href="/creator-chat/" class="chat-widget-button" id="chatWidgetButton">
    <i class="fas fa-headset"></i>
    <div class="notification-badge" id="notificationBadge" style="display: none;"></div>
  </a>
</div>

<!-- Toast Notification -->
<div class="message-toast" id="messageToast">
  <div class="toast-icon">
    <i class="fas fa-comment"></i>
  </div>
  <div class="toast-content">
    <div class="toast-title" id="toastTitle">New Message</div>
    <div class="toast-message" id="toastMessage">You have a new message from support</div>
  </div>
</div>

<!-- Sound Element -->
<audio id="messageSound" preload="auto">
  <source src="https://assets.mixkit.co/sfx/preview/mixkit-correct-answer-tone-2870.mp3" type="audio/mpeg">
</audio>

<!-- Chat Widget Script -->
<script>
// Chat Widget State
let widgetUnreadCount = 0;
let hasNewMessage = false;

// Initialize Chat Widget
function initializeChatWidget() {
  console.log('Initializing chat widget notifications...');
  
  // Check for new messages on load
  checkForNewMessages();
  
  // Set up periodic checking for new messages
  setInterval(checkForNewMessages, 30000); // Check every 30 seconds
  
  // Set up click handler to clear notifications
  document.getElementById('chatWidgetButton').addEventListener('click', function() {
    clearNotifications();
  });
}

// Check for new messages
function checkForNewMessages() {
  // Simulate checking for new messages
  // In your actual implementation, you would check Firebase or your backend
  const hasMessages = Math.random() > 0.7; // 30% chance of new message for demo
  
  if (hasMessages && !hasNewMessage) {
    widgetUnreadCount++;
    hasNewMessage = true;
    updateWidgetBadge(widgetUnreadCount);
    showMessageNotification();
    playMessageSound();
  }
}

// Update badge
function updateWidgetBadge(count) {
  const badge = document.getElementById('notificationBadge');
  const button = document.getElementById('chatWidgetButton');
  
  if (count > 0) {
    badge.style.display = 'flex';
    badge.textContent = count > 9 ? '9+' : count;
    button.classList.add('has-notification');
  } else {
    badge.style.display = 'none';
    button.classList.remove('has-notification');
  }
}

// Show notification
function showMessageNotification() {
  const toast = document.getElementById('messageToast');
  document.getElementById('toastTitle').textContent = 'New Message';
  document.getElementById('toastMessage').textContent = 'You have a new message from support';
  
  toast.classList.add('show');
  
  // Auto hide after 5 seconds
  setTimeout(() => {
    toast.classList.remove('show');
  }, 5000);
}

// Play sound
function playMessageSound() {
  const sound = document.getElementById('messageSound');
  if (sound) {
    sound.currentTime = 0;
    sound.play().catch(e => console.log('Audio play failed:', e));
  }
}

// Clear notifications when chat button is clicked
function clearNotifications() {
  widgetUnreadCount = 0;
  hasNewMessage = false;
  updateWidgetBadge(0);
  
  const toast = document.getElementById('messageToast');
  toast.classList.remove('show');
}

// Initialize when page loads
document.addEventListener('DOMContentLoaded', function() {
  console.log('Setting up chat widget notifications...');
  initializeChatWidget();
});
</script> 
  
</body>



</html>
